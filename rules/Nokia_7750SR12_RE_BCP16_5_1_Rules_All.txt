#### define global parameters ####
{-
device_type = Nokia_7750SR12_RE
BCP_version = 16.5.1
report_type = BCP Base Config Conformance
input_dir = /data/conformance/configs/
input_suffix = .filter.config
output_dir = /data/conformance/output/
www_dir =  /usr/local/www/apache22/data/conformance/nokia/
www_url_base = nokia/
#from = feng.wang\@telus.com
#to = feng.wang\@telus.com
output_report_summary_file = Nokia_7750SR12_RE_BCP16.5.1_conformance_summary.html
output_report_detail_file = Nokia_7750SR12_RE_BCP16.5.1_conformance_detail.html
output_report_log_file = Nokia_7750SR12_RE_BCP16.5.1_conformance_log.txt
report_title = Nokia 7750SR12 RE BCP 16.5.1 Conformance
-}

#### define system rules ####
<-get_version
<#type=get_parameter>
^(TiMOS.+?) .+
->

<-get_province
<#type=get_parameter>
^/config system name "\w{4}(\w{2})\w{4}\d{2}"
->

<-system_version
<#weight=info>
r<(?:TiMOS-C-11.0.R1[28]|TiMOS-C-13.0.R10) cpm\/hops.+>
->

<- system_global
/config system chassis-mode d
/config system power-supply 1 dc
/config system power-supply 2 dc
r</config system (?:l4-load-balancing|load-balancing l4-load-balancing)>
r</config system (?:lsr-load-balancing|load-balancing lsr-load-balancing) lbl-ip>
/config system snmp packet-size 9216
/config system lldp tx-interval 20
/config system lldp tx-hold-multiplier 3
->

<- system_persistence
<#type=dynamic>
<#match=any_if_found>
<#instance = /config subscriber-mgmt authentication-policy "(ssc_auth_policy)" create>
/config system persistence subscriber-mgmt location cf1:
->

<- system_login-control
/config system login-control ftp inbound-max-sessions 5
/config system login-control ssh outbound-max-sessions 0
/config system login-control telnet outbound-max-sessions 0
/config system login-control idle-timeout 20
r</config system login-control motd url "(?:cf3:)?motd.txt">
/config system login-control no login-banner
->

<- system_time_BC
<#condition=get_province=BC>
/config system time sntp server-address 192.197.169.8 preferred
/config system time sntp server-address 192.197.169.28
/config system time sntp no shutdown
/config system time zone UTC
->

<- system_time_AB
<#condition=get_province=AB>
/config system time sntp server-address 207.229.63.74 preferred
/config system time sntp server-address 207.229.63.204
/config system time sntp no shutdown
/config system time zone UTC
->

<- system_time_EAST
<#condition=get_province=(MB|ON|PQ)>
/config system time sntp server-address 209.202.66.10 preferred
/config system time sntp server-address 209.202.66.195
/config system time sntp no shutdown
/config system time zone UTC
->


<- system_threshold
/config system thresholds rmon alarm 100 variable-oid sgiCpuUsage.0 interval 300 startup-alarm rising rising-event 1001 rising-threshold 60 falling-event 1002 falling-threshold 59
/config system thresholds rmon alarm 101 variable-oid sgiMemoryUsed.0 interval 300 startup-alarm rising rising-event 1003 rising-threshold 1400000000 falling-event 1004 falling-threshold 1399999999
/config system thresholds rmon alarm 102 variable-oid sgiMemoryUsed.0 interval 300 startup-alarm rising rising-event 1005 rising-threshold 1600000000 falling-event 1006 falling-threshold 1599999999
/config system thresholds rmon event 1001 description "CPU utilization alarm"
/config system thresholds rmon event 1002 description "CPU utilization alarm clear"
/config system thresholds rmon event 1003 description "memory utilization alarm"
/config system thresholds rmon event 1004 description "memory utilization alarm clear"
/config system thresholds rmon event 1005 description "memory utilization usage alarm"
/config system thresholds rmon event 1006 description "memory utilization usage alarm clear"
/config system thresholds cflash-cap-alarm cf3-A: rising-threshold 1950000 falling-threshold 1949999 interval 300
/config system thresholds cflash-cap-alarm cf3-B: rising-threshold 1950000 falling-threshold 1949999 interval 300
/config system thresholds cflash-cap-warn cf3-A: rising-threshold 1800000 falling-threshold 1799999 interval 300
/config system thresholds cflash-cap-warn cf3-B: rising-threshold 1800000 falling-threshold 1799999 interval 300
/config system thresholds memory-use-alarm rising-threshold 1600000000 falling-threshold 1599999999 interval 300
/config system thresholds memory-use-warn rising-threshold 1400000000 falling-threshold 1399999999 interval 300
->

<- system_tacplus_BC
<#condition=get_province=BC>
/config system security tacplus accounting
/config system security tacplus timeout 10
r</config system security tacplus server \d address 192.197.169.115 secret "A/YCLyP7rvJcAZepBsSHde5IG8ViR254DUI2iDjULXg" hash2>
r</config system security tacplus server \d address 192.197.169.116 secret "A/YCLyP7rvIcsEOBZ3yyhVVqTnjeZnETO.O.OPszzy6" hash2>
->

<- system_tacplus_AB
<#condition=get_province=AB>
/config system security tacplus accounting
/config system security tacplus timeout 10
r</config system security tacplus server \d address 207.229.63.231 secret "4SsnH/VoyL.bA5.dwtnIvG2aaKD4Vq8oD.VtXKEJxw6" hash2>
r</config system security tacplus server \d address 198.161.151.95 secret "MAjSf446pEiCuYgAEtiUDqsWPtFgbnOlSOQl6jmcm2U" hash2>
->

<- system_tacplus_EAST
<#condition=get_province=(MB|NB|NS|SK|ON|PQ)>
/config system security tacplus accounting
/config system security tacplus timeout 10
r</config system security tacplus server \d address 198.161.154.43 secret "MAjSf446pEiq3R2C8RIKJpKWMYl6M9.VUatCZvESMn." hash2>
r</config system security tacplus server \d address 209.202.66.133 secret "bCwVrXWYK2ZWJvo1COlVkDMK797knk39h5lBKuePR1E" hash2>
->

<- log_file_id
#/config log file-id 1 description "Log ALL changes to CF2 for <= 20days."
/config log file-id 1 location cf2:
/config log file-id 1 rollover 2880 retention 500
/config log file-id 3 description "Combined Network Ing Egr Octets"
/config log file-id 3 location cf2:
/config log file-id 3 rollover 15 retention 6
/config log file-id 77 description "BI/CI SAP accounting log"
/config log file-id 77 location cf2:
/config log file-id 77 rollover 5 retention 24
/config log file-id 78 description "BI/CI SDP accounting log"
/config log file-id 78 location cf2:
/config log file-id 78 rollover 5 retention 24
->

<- log_accounting-policy
/config log accounting-policy 3 description "Combined Network Ing Egr Octets"
/config log accounting-policy 3 record combined-network-ing-egr-octets
/config log accounting-policy 3 to file 3
/config log accounting-policy 3 no shutdown
/config log accounting-policy 77 description "BI/CI SAP usage"
/config log accounting-policy 77 record complete-service-ingress-egress
/config log accounting-policy 77 to file 77
/config log accounting-policy 77 no shutdown
/config log accounting-policy 78 description "BI/CI SDP usage"
/config log accounting-policy 78 record complete-sdp-ingress-egress
/config log accounting-policy 78 to file 78
/config log accounting-policy 78 no shutdown
->

<- log_filter
/config log filter 98 default-action forward
/config log filter 98 description "filter out specific entries from snmp traps to SAM"
/config log filter 98 entry 10 action drop
/config log filter 98 entry 10 description "Managed SAP creation failure"
/config log filter 98 entry 10 match application eq "svcmgr"
/config log filter 98 entry 10 match number eq 2214
/config log filter 98 entry 20 action drop
/config log filter 98 entry 20 description "Host connectivity lost"
/config log filter 98 entry 20 match application eq "svcmgr"
/config log filter 98 entry 20 match number eq 2206
/config log filter 98 entry 30 action drop
/config log filter 98 entry 30 description "Host connectivity restored"
/config log filter 98 entry 30 match application eq "svcmgr"
/config log filter 98 entry 30 match number eq 2207
/config log filter 98 entry 40 action drop
/config log filter 98 entry 40 description "tmnxNatLsnSubUdpPortUsageHigh"
/config log filter 98 entry 40 match application eq "nat"
/config log filter 98 entry 40 match number eq 2005
/config log filter 98 entry 50 action drop
/config log filter 98 entry 50 description "tmnxNatLsnSubTcpPortUsageHigh"
/config log filter 98 entry 50 match application eq "nat"
/config log filter 98 entry 50 match number eq 2006
/config log filter 98 entry 60 action drop
/config log filter 98 entry 60 description "tmnxLogFileDeleted"
/config log filter 98 entry 60 match application eq "logger"
/config log filter 98 entry 60 match number eq 2009
/config log filter 99 default-action forward
/config log filter 99 description "filter out specific entries from log"
/config log filter 99 entry 10 action drop
/config log filter 99 entry 10 match application eq "svcmgr"
/config log filter 99 entry 10 match severity lte minor
/config log filter 99 entry 20 action drop
/config log filter 99 entry 20 description "message--log file has been rolled over"
/config log filter 99 entry 20 match application eq "logger"
/config log filter 99 entry 20 match number eq 2008
/config log filter 99 entry 30 action drop
/config log filter 99 entry 30 description "message--log file has been deleted"
/config log filter 99 entry 30 match application eq "logger"
/config log filter 99 entry 30 match number eq 2009
/config log filter 99 entry 40 action drop
/config log filter 99 entry 40 description "filter accounting log 77 from log-id 99"
/config log filter 99 entry 40 match subject eq "acct-log-id 77" regexp
/config log filter 99 entry 50 action drop
/config log filter 99 entry 50 description "filter accounting log 78 from log-id 99"
/config log filter 99 entry 50 match subject eq "acct-log-id 78" regexp
->

<- log_event_control
/config log event-control "chassis" 2052 generate major
/config log event-control "chassis" 2058 generate major
/config log event-control "chassis" 2059 generate major
/config log event-control "chassis" 2063 generate major
/config log event-control "chassis" 2076 generate major
/config log event-control "chassis" 2098 generate major
/config log event-control "chassis" 2099 generate major
/config log event-control "chassis" 2101 generate major
/config log event-control "chassis" 2102 generate major
/config log event-control "chassis" 2103 generate major
/config log event-control "igmp" 2005 suppress
/config log event-control "video" 2009 suppress
/config log event-control "video" 2010 suppress
/config log event-control "ip" 2003 generate major
/config log event-control "ip" 2008 generate major
/config log event-control "ip" 2009 generate major
/config log event-control "mc_redundancy" 2001 generate major
/config log event-control "mc_redundancy" 2002 generate major
/config log event-control "svcmgr" 2206 suppress
/config log event-control "svcmgr" 2207 suppress
->

<- log_event_control_SROS11
/config log event-control "chassis" 2110 generate major
/config log event-control "chassis" 2111 generate
/config log event-control "chassis" 2112 generate
/config log event-control "chassis" 2126 generate
/config log event-control "dhcps" 2017 suppress
/config log event-control "dhcps" 2018 suppress
/config log event-control "dhcps" 2019 suppress
/config log event-control "dhcps" 2022 suppress
->

<- log_syslog_BC
<#condition=get_province=BC>
#/config log syslog 1 description "Log MAIN and SECURITY events"
/config log syslog 1 address 192.197.169.31
/config log syslog 1 log-prefix "s<HOSTNAME>"
#/config log syslog 2 description "Log MAIN and SECURITY events"
/config log syslog 2 address 207.229.63.189
/config log syslog 2 log-prefix "s<HOSTNAME>"
->

<- log_syslog_AB
<#condition=get_province=AB>
#/config log syslog 1 description "Log MAIN and SECURITY events"
/config log syslog 1 address 207.229.63.189
/config log syslog 1 log-prefix "s<HOSTNAME>"
#/config log syslog 2 description "Log MAIN and SECURITY events"
/config log syslog 2 address 209.202.66.5
/config log syslog 2 log-prefix "s<HOSTNAME>"
->

<- log_syslog_EAST
<#condition=get_province=(MB|ON|PQ)>
#/config log syslog 1 description "Log MAIN and SECURITY events"
/config log syslog 1 address 209.202.66.5
/config log syslog 1 log-prefix "s<HOSTNAME>"
#/config log syslog 2 description "Log MAIN and SECURITY events"
/config log syslog 2 address 207.229.63.189
/config log syslog 2 log-prefix "s<HOSTNAME>"
->



<- log_log_id
/config log snmp-trap-group 98 description "5620sam"
r</config log snmp-trap-group 98 trap-target "(?:primary_SAM|154.11.169.201:162)" address 154.11.169.201 snmpv2c notify-community "privatetrap98">
r</config log snmp-trap-group 98 trap-target "(?:redundancy_SAM|154.11.169.22:162)" address 154.11.169.22 snmpv2c notify-community "privatetrap98">
/config log log-id 1 description "Full message log"
/config log log-id 1 time-format local
/config log log-id 1 from main security change
/config log log-id 1 to file 1
/config log log-id 2 from main security change
/config log log-id 2 to syslog 1
/config log log-id 3 from main security change
/config log log-id 3 to syslog 2
/config log log-id 5 description "CLI Changes log"
/config log log-id 5 time-format local
/config log log-id 5 from change
r</config log log-id 5 to memory>
#/config log log-id 50 shutdown
#/config log log-id 50 description "Debugs - use only when necessary - shutdown after use"
/config log log-id 50 from debug-trace
r</config log log-id 50 to memory>
/config log log-id 98 from main security change
/config log log-id 98 to snmp 1024
/config log log-id 98 filter 98
/config log log-id 99 filter 99
/config log log-id 99 from main security
->

<- router_management
r</config router management static-route 96.1.164.32/27 next-hop \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}>
r</config router management static-route 96.1.254.0/23 next-hop \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}>
r</config router management static-route 142.168.251.0/24 next-hop \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}>
r</config router management static-route 142.169.200.0/25 next-hop \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}>
r</config router management static-route 192.197.168.96/27 next-hop \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}>
->

<- system_rollback
<#condition=get_version=(TiMOS-C-11.0.R18|TiMOS-C-11.0.R12)>
/config system rollback rollback-location "cf3:\rollback\rollback.rb"
/config cron script "AUTO_RB" description "Auto rollback job"
/config cron script "AUTO_RB" location "cf3:\rollback_save.txt"
/config cron script "AUTO_RB" no shutdown
/config cron script "DELETE_RB_LOG" description "delete RB script results"
/config cron script "DELETE_RB_LOG" location "cf3:\rb_delete.txt"
/config cron script "DELETE_RB_LOG" no shutdown
/config cron action "AUTO_RB" results "cf2:\RB\results"
/config cron action "AUTO_RB" script "AUTO_RB"
/config cron action "AUTO_RB" max-completed 255
/config cron action "AUTO_RB" no shutdown
/config cron action "RB_DELETE" results "cf2:\RB\results"
/config cron action "RB_DELETE" script "DELETE_RB_LOG"
/config cron action "RB_DELETE" max-completed 255
/config cron action "RB_DELETE" no shutdown
/config cron schedule "AUTO_RB" owner "admin" interval 86400
/config cron schedule "AUTO_RB" owner "admin" action "AUTO_RB"
/config cron schedule "AUTO_RB" owner "admin" day-of-month all
/config cron schedule "AUTO_RB" owner "admin" no shutdown
/config cron schedule "RB_DELETE" owner "admin" interval 604800
/config cron schedule "RB_DELETE" owner "admin" action "RB_DELETE"
/config cron schedule "RB_DELETE" owner "admin" day-of-month all
/config cron schedule "RB_DELETE" owner "admin" no shutdown
->

<- system_rollback
<#condition=get_version=TiMOS-C-13.0.R10>
/config system rollback rollback-location "cf3:\rollback\rollback.rb"
/config system rollback local-max-checkpoints 5
/config system cron schedule "AUTO_RB"  owner "admin" interval 86400
/config system cron schedule "AUTO_RB"  owner "admin" script-policy "AUTO_RB"
/config system cron schedule "AUTO_RB"  owner "admin" day-of-month all
/config system cron schedule "AUTO_RB"  owner "admin" no shutdown
/config system cron schedule "RB_DELETE"  owner "admin" interval 604800
/config system cron schedule "RB_DELETE"  owner "admin" script-policy "RB_DELETE"
/config system cron schedule "RB_DELETE"  owner "admin" day-of-month all
/config system cron schedule "RB_DELETE"  owner "admin" no shutdown
/config system script-control script "AUTO_RB" description "Auto rollback job"
/config system script-control script "AUTO_RB" location "cf3:\rollback_save.txt"
/config system script-control script "AUTO_RB" no shutdown
/config system script-control script "DELETE_RB_LOG" description "delete RB script results"
/config system script-control script "DELETE_RB_LOG" location "cf3:\rb_delete.txt"
/config system script-control script "DELETE_RB_LOG" no shutdown
/config system script-control script-policy "AUTO_RB" results "cf2:\RB\results"
/config system script-control script-policy "AUTO_RB" script "AUTO_RB"
/config system script-control script-policy "AUTO_RB" max-completed 255
/config system script-control script-policy "AUTO_RB" no shutdown
/config system script-control script-policy "RB_DELETE" results "cf2:\RB\results"
/config system script-control script-policy "RB_DELETE" script "DELETE_RB_LOG"
/config system script-control script-policy "RB_DELETE" max-completed 255
/config system script-control script-policy "RB_DELETE" no shutdown
->


####Feng removed 2015-07-09, see below actual config from CLGRAB21RE02####
####/config eth-cfm domain 2 format none level 2 association 817 format icc-based name "FILTER1335018" bridge-identifier 3007054####
#<- eth-cfm
#/config eth-cfm domain 2 format none level 2
#/config eth-cfm domain 3 format none level 3
#/config eth-cfm domain 4 format none level 4
#/config eth-cfm domain 5 format none level 5
#->

####Feng removed clfowd rules 2015-07-09####
#<- cflowd
#/config cflowd active-timeout 1
#r</config cflowd collector \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}:5000 version 9 description ".+?">
#->

<- card_mcast-path-management_iom3-xp
#some iom3-xp card has isa-bb mda
<#type=dynamic>
<#match=any_if_found>
<#instance=/config card (\d{1,2}) mda [12] mda-type (?:m2-10gb-xp-xfp|m20-1gb-xp-sfp)>
/config card i<1> fp 1 ingress mcast-path-management no shutdown
->

<- card_mcast-path-management_imm
<#type=dynamic>
<#match=any_if_found>
<#instance=/config card (\d{1,2}) card-type (?:imm12-10gb-sf\+|imm1-100gb-cfp|imm-1pac-fp3)>
/config card i<1> fp 1 ingress mcast-path-management no shutdown
->


<- card_IOM_type
<#type=dynamic>
<#match=any_if_found>
<#instance=/config card (\d{1,2}) card-type>
r</config card i<1> card-type (?:iom3-xp|imm12-10gb-sf\+|imm1-100gb-cfp|imm-2pac-fp3|imm-1pac-fp3)>
->

<- card_MDA_type
<#type=dynamic>
<#match=any_if_found>
<#instance=/config card (\d{1,2} mda [1-2]) mda-type>
r</config card i<1> mda-type (?:m20-1gb-xp-sfp|m2-10gb-xp-xfp|m60-10/100eth-tx|m48-1gb-xp-tx|isa-tunnel|isa-bb|p6-10g-sfp|p1-100g-cfp|isa2-bb)>
->

<- round-robin-inactive-records
/config mcast-management chassis-level round-robin-inactive-records
->


#### define security rules ####
<- system_security_no_telnet
<#match=none>
/config system security telnet-server
->

<- system_security_global
/config system security ftp-server
/config system security password authentication-order tacplus local  exit-on-reject
/config system security user-template "tacplus_default" access console ftp
/config system security user-template "tacplus_default" console login-exec "cf3:\enable-alias"
/config system security ssh preserve-key
->

<- system_security_maf_ip-filter
/config system security management-access-filter ip-filter shutdown
/config system security management-access-filter ip-filter default-action permit
/config system security management-access-filter ip-filter entry 100 description "Allow connections from BC NOC 1"
/config system security management-access-filter ip-filter entry 100 src-ip 192.197.176.0/24
/config system security management-access-filter ip-filter entry 100 action permit
/config system security management-access-filter ip-filter entry 101 description "Allow connections from BC NOC 2"
/config system security management-access-filter ip-filter entry 101 src-ip 192.197.169.0/24
/config system security management-access-filter ip-filter entry 101 action permit
/config system security management-access-filter ip-filter entry 102 description "Allow connections from BC NOC 3"
/config system security management-access-filter ip-filter entry 102 src-ip 192.197.168.96/27
/config system security management-access-filter ip-filter entry 102 action permit
/config system security management-access-filter ip-filter entry 120 description "Allow connections from AB NOC 1"
/config system security management-access-filter ip-filter entry 120 src-ip 207.229.63.0/24
/config system security management-access-filter ip-filter entry 120 action permit
/config system security management-access-filter ip-filter entry 121 description "Allow connections from AB NOC 2"
/config system security management-access-filter ip-filter entry 121 src-ip 198.161.151.0/24
/config system security management-access-filter ip-filter entry 121 action permit
/config system security management-access-filter ip-filter entry 122 description "Allow connections from AB NOC 3"
/config system security management-access-filter ip-filter entry 122 src-ip 154.11.169.0/25
/config system security management-access-filter ip-filter entry 122 action permit
/config system security management-access-filter ip-filter entry 123 description "Allow connections from AB NOC 4"
/config system security management-access-filter ip-filter entry 123 src-ip 154.11.169.128/25
/config system security management-access-filter ip-filter entry 123 action permit
/config system security management-access-filter ip-filter entry 140 description "Allow connections from ON NOC 1"
/config system security management-access-filter ip-filter entry 140 src-ip 209.202.66.0/24
/config system security management-access-filter ip-filter entry 140 action permit
/config system security management-access-filter ip-filter entry 141 description "Allow connections from ON NOC 2"
/config system security management-access-filter ip-filter entry 141 src-ip 198.161.154.0/25
/config system security management-access-filter ip-filter entry 141 action permit
/config system security management-access-filter ip-filter entry 142 description "Allow connections from ON NOC 3"
/config system security management-access-filter ip-filter entry 142 src-ip 96.1.164.32/27
/config system security management-access-filter ip-filter entry 142 action permit
/config system security management-access-filter ip-filter entry 160 description "Allow connections from PQ NOC 1"
/config system security management-access-filter ip-filter entry 160 src-ip 142.168.251.0/24
/config system security management-access-filter ip-filter entry 160 action permit
/config system security management-access-filter ip-filter entry 161 description "Allow connections from PQ NOC 2"
/config system security management-access-filter ip-filter entry 161 src-ip 142.169.200.0/25
/config system security management-access-filter ip-filter entry 161 action permit
/config system security management-access-filter ip-filter entry 170 description "Allow connections from New OSS LAN in Calgary/Edmonton/Toronto"
/config system security management-access-filter ip-filter entry 170 src-ip 96.1.254.0/23
/config system security management-access-filter ip-filter entry 170 action permit
/config system security management-access-filter ip-filter entry 200 description "Allow Arbor edtnabxmsv01"
/config system security management-access-filter ip-filter entry 200 src-ip 205.233.111.106/32
/config system security management-access-filter ip-filter entry 200 action permit
/config system security management-access-filter ip-filter entry 201 description "Allow Arbor mtrlpqfbsv01"
/config system security management-access-filter ip-filter entry 201 src-ip 154.11.7.12/32
/config system security management-access-filter ip-filter entry 201 action permit
/config system security management-access-filter ip-filter entry 202 description "Allow Arbor mtrlpqfbsv02"
/config system security management-access-filter ip-filter entry 202 src-ip 154.11.7.39/32
/config system security management-access-filter ip-filter entry 202 action permit
/config system security management-access-filter ip-filter entry 203 description "Allow Arbor nwmrbc01sv01"
/config system security management-access-filter ip-filter entry 203 src-ip 204.174.217.42/32
/config system security management-access-filter ip-filter entry 203 action permit
/config system security management-access-filter ip-filter entry 204 description "Allow Arbor nwmrbc01sv03"
/config system security management-access-filter ip-filter entry 204 src-ip 204.174.217.21/32
/config system security management-access-filter ip-filter entry 204 action permit
/config system security management-access-filter ip-filter entry 205 description "Allow Arbor toroonnlsv01"
/config system security management-access-filter ip-filter entry 205 src-ip 154.11.6.82/32
/config system security management-access-filter ip-filter entry 205 action permit
/config system security management-access-filter ip-filter entry 206 description "Allow Arbor toroonxnsv01"
/config system security management-access-filter ip-filter entry 206 src-ip 154.11.6.22/32
/config system security management-access-filter ip-filter entry 206 action permit
/config system security management-access-filter ip-filter entry 207 description "Allow Arbor toroonxnsv02"
/config system security management-access-filter ip-filter entry 207 src-ip 154.11.6.62/32
/config system security management-access-filter ip-filter entry 207 action permit
/config system security management-access-filter ip-filter entry 208 description "Allow Arbor vancbc01sv01"
/config system security management-access-filter ip-filter entry 208 src-ip 204.174.217.3/32
/config system security management-access-filter ip-filter entry 208 action permit
/config system security management-access-filter ip-filter entry 209 description "Allow Arbor clgrab01sv01"
/config system security management-access-filter ip-filter entry 209 src-ip 208.38.16.131/32
/config system security management-access-filter ip-filter entry 209 action permit
/config system security management-access-filter ip-filter entry 210 description "Allow Arbor clgrab21sv01"
/config system security management-access-filter ip-filter entry 210 src-ip 208.38.16.136/32
/config system security management-access-filter ip-filter entry 210 action permit
/config system security management-access-filter ip-filter entry 211 description "Allow Arbor QUBCPQAJSV01"
/config system security management-access-filter ip-filter entry 211 src-ip 142.173.62.2/32
/config system security management-access-filter ip-filter entry 211 action permit
/config system security management-access-filter ip-filter entry 212 description "Allow Arbor MTRLPQFBSV04"
/config system security management-access-filter ip-filter entry 212 src-ip 142.173.61.12/32
/config system security management-access-filter ip-filter entry 212 action permit
/config system security management-access-filter ip-filter entry 220 description "Allow Arbor/Peakflow Servers - National"
/config system security management-access-filter ip-filter entry 220 src-ip 96.1.178.0/24
/config system security management-access-filter ip-filter entry 220 action permit
/config system security management-access-filter ip-filter entry 225 description "Allow Arbor/Peakflow Servers - National"
/config system security management-access-filter ip-filter entry 225 src-ip 96.1.183.0/24
/config system security management-access-filter ip-filter entry 225 action permit
/config system security management-access-filter ip-filter entry 230 description "Allow Arbor/Peakflow Servers - MTRLPQFB"
/config system security management-access-filter ip-filter entry 230 src-ip 204.225.242.64/27
/config system security management-access-filter ip-filter entry 230 action permit
/config system security management-access-filter ip-filter entry 235 description "Allow Arbor/Peakflow Servers - National"
/config system security management-access-filter ip-filter entry 400 description "Allow connections from GCNet OSS Edmonton"
/config system security management-access-filter ip-filter entry 400 src-ip 100.70.15.192/26
/config system security management-access-filter ip-filter entry 400 action permit
/config system security management-access-filter ip-filter entry 405 description "Allow connections from GCNet OSS QIDC"
/config system security management-access-filter ip-filter entry 405 src-ip 100.70.22.0/26
/config system security management-access-filter ip-filter entry 405 action permit
/config system security management-access-filter ip-filter entry 235 src-ip 96.1.164.240/28
/config system security management-access-filter ip-filter entry 235 action permit
/config system security management-access-filter ip-filter entry 500 description "Deny all telnet"
/config system security management-access-filter ip-filter entry 500 protocol tcp
/config system security management-access-filter ip-filter entry 500 dst-port 23 65535
/config system security management-access-filter ip-filter entry 500 action deny
/config system security management-access-filter ip-filter entry 505 description "Deny all SSH"
/config system security management-access-filter ip-filter entry 505 protocol tcp
/config system security management-access-filter ip-filter entry 505 dst-port 22 65535
/config system security management-access-filter ip-filter entry 505 action deny
/config system security management-access-filter ip-filter entry 510 description "Deny all FTP"
/config system security management-access-filter ip-filter entry 510 protocol tcp
/config system security management-access-filter ip-filter entry 510 dst-port 20 65534
/config system security management-access-filter ip-filter entry 510 action deny
/config system security management-access-filter ip-filter entry 515 description "Deny all TFTP"
/config system security management-access-filter ip-filter entry 515 protocol tcp
/config system security management-access-filter ip-filter entry 515 dst-port 69 65535
/config system security management-access-filter ip-filter entry 515 action deny
/config system security management-access-filter ip-filter entry 520 description "Deny all snmp - tcp"
/config system security management-access-filter ip-filter entry 520 protocol tcp
/config system security management-access-filter ip-filter entry 520 dst-port 161 65532
/config system security management-access-filter ip-filter entry 520 action deny
/config system security management-access-filter ip-filter entry 525 description "Deny all snmp - udp"
/config system security management-access-filter ip-filter entry 525 protocol udp
/config system security management-access-filter ip-filter entry 525 dst-port 161 65532
/config system security management-access-filter ip-filter entry 525 action deny
/config system security management-access-filter ip-filter entry 530 description "Deny all netconf - tcp"
/config system security management-access-filter ip-filter entry 530 protocol tcp
/config system security management-access-filter ip-filter entry 530 dst-port 830 65535
/config system security management-access-filter ip-filter entry 530 action deny
/config system security management-access-filter ip-filter entry 535 description "Deny gsmp-ancp - tcp"
/config system security management-access-filter ip-filter entry 535 protocol tcp
/config system security management-access-filter ip-filter entry 535 dst-port 6068 65535
/config system security management-access-filter ip-filter entry 535 action deny
/config system security management-access-filter ip-filter entry 540 description "Deny snmp streaming - tcp"
/config system security management-access-filter ip-filter entry 540 protocol tcp
/config system security management-access-filter ip-filter entry 540 dst-port 1491 65535
/config system security management-access-filter ip-filter entry 540 action deny
/config system security management-access-filter ip-filter no shutdown
->

<- system_security_maf_ipv6-filter
/config system security management-access-filter ipv6-filter shutdown
/config system security management-access-filter ipv6-filter default-action permit
/config system security management-access-filter ipv6-filter entry 500 description "Deny all telnet"
/config system security management-access-filter ipv6-filter entry 500 next-header tcp
/config system security management-access-filter ipv6-filter entry 500 dst-port 23 65535
/config system security management-access-filter ipv6-filter entry 500 action deny
/config system security management-access-filter ipv6-filter entry 505 description "Deny all SSH"
/config system security management-access-filter ipv6-filter entry 505 next-header tcp
/config system security management-access-filter ipv6-filter entry 505 dst-port 22 65535
/config system security management-access-filter ipv6-filter entry 505 action deny
/config system security management-access-filter ipv6-filter entry 510 description "Deny all FTP"
/config system security management-access-filter ipv6-filter entry 510 next-header tcp
/config system security management-access-filter ipv6-filter entry 510 dst-port 20 65534
/config system security management-access-filter ipv6-filter entry 510 action deny
/config system security management-access-filter ipv6-filter entry 515 description "Deny all TFTP"
/config system security management-access-filter ipv6-filter entry 515 next-header udp
/config system security management-access-filter ipv6-filter entry 515 dst-port 69 65534
/config system security management-access-filter ipv6-filter entry 515 action deny
/config system security management-access-filter ipv6-filter entry 520 description "Deny all snmp - tcp"
/config system security management-access-filter ipv6-filter entry 520 next-header tcp
/config system security management-access-filter ipv6-filter entry 520 dst-port 161 65532
/config system security management-access-filter ipv6-filter entry 520 action deny
/config system security management-access-filter ipv6-filter entry 525 description "Deny all snmp - udp"
/config system security management-access-filter ipv6-filter entry 525 next-header udp
/config system security management-access-filter ipv6-filter entry 525 dst-port 161 65532
/config system security management-access-filter ipv6-filter entry 525 action deny
/config system security management-access-filter ipv6-filter no shutdown
->

<- system_security_profile_default
/config system security profile "default" default-action deny-all
/config system security profile "default" entry 10 match "exec"
/config system security profile "default" entry 10 action permit
/config system security profile "default" entry 20 match "exit"
/config system security profile "default" entry 20 action permit
/config system security profile "default" entry 30 match "help"
/config system security profile "default" entry 30 action permit
/config system security profile "default" entry 40 match "logout"
/config system security profile "default" entry 40 action permit
/config system security profile "default" entry 50 match "password"
/config system security profile "default" entry 50 action permit
/config system security profile "default" entry 60 match "admin display-config"
/config system security profile "default" entry 60 action permit
/config system security profile "default" entry 65 match "show li"
/config system security profile "default" entry 65 action deny
/config system security profile "default" entry 66 match "clear li"
/config system security profile "default" entry 66 action deny
/config system security profile "default" entry 70 match "show"
/config system security profile "default" entry 70 action permit
/config system security profile "default" entry 80 match "enable-admin"
/config system security profile "default" entry 80 action permit
/config system security profile "default" entry 90 match "ping"
/config system security profile "default" entry 90 action permit
/config system security profile "default" entry 100 match "configure li"
/config system security profile "default" entry 100 action deny
/config system security profile "default" entry 110 match "environment more"
/config system security profile "default" entry 110 action permit
/config system security profile "default" entry 120 match "environment time-stamp"
/config system security profile "default" entry 120 action permit
/config system security profile "default" entry 130 match "environment terminal length"
/config system security profile "default" entry 130 action permit
/config system security profile "default" entry 140 match "tools perform subscriber-mgmt forcerenew"
/config system security profile "default" entry 140 action permit
/config system security profile "default" entry 150 match "monitor"
/config system security profile "default" entry 150 action permit
/config system security profile "default" entry 160 match "traceroute"
/config system security profile "default" entry 160 action permit
/config system security profile "default" entry 170 match "tools dump system-resources"
/config system security profile "default" entry 170 action permit
/config system security profile "default" entry 180 match "oam host-connectivity-verify"
/config system security profile "default" entry 180 action permit
/config system security profile "default" entry 190 match "environment alias"
/config system security profile "default" entry 190 action permit
/config system security profile "default" entry 200 match "clear service"
/config system security profile "default" entry 200 action permit
->

<- system_user
#/config system security user "admin" password "imtjq1/92qVJLjIA3atLkE" hash2
/config system security user "admin" access console ftp
/config system security user "admin" console member "administrative"
#/config system security user "console" password "s/dKILlSv9tqlFRGxwF3rZSYt5eejQMt" hash2
/config system security user "console" access console ftp
/config system security user "console" console no member "default"
/config system security user "console" console member "administrative"
#/config system security user "samftp" password "eLiMn00bveqPsJtP3wv6Qk" hash2
/config system security user "samftp" access ftp
/config system security user "samftp" console no member "default"
->

<- system_snmp
/config system security snmp view "CUTDOWN" subtree "1.3.6.1" mask ff
/config system security snmp view "CUTDOWN" subtree "1.3.6.1.2.1.3" mask ff type excluded
/config system security snmp view "CUTDOWN" subtree "1.3.6.1.2.1.4.21" mask ff type excluded
/config system security snmp view "CUTDOWN" subtree "1.3.6.1.2.1.4.22" mask ff type excluded
/config system security snmp view "CUTDOWN" subtree "1.3.6.1.2.1.4.24.4" mask ff type excluded
/config system security snmp access group "TELUS-RO" security-model snmpv2c security-level no-auth-no-privacy read "CUTDOWN" notify "CUTDOWN"
/config system security snmp access group "TELUS-RW" security-model snmpv2c security-level no-auth-no-privacy read "CUTDOWN" write "CUTDOWN" notify "CUTDOWN"
/config system security snmp attempts 5 time 30 lockout 10
/config system security snmp community "pJLNrI/ikqDUcOlmdNV7YU" hash2 rwa version both
/config system security snmp usm-community "HFfbWn8h4Wui3eXmRzpRYU" hash2 group "TELUS-RO"
->

<- system_cpm_queue
/config system security per-peer-queuing
/config system security cpm-queue queue 33 create
/config system security cpm-queue queue 33 rate 100000 cir 100000
/config system security cpm-queue queue 34 create
/config system security cpm-queue queue 34 rate 5000 cir 5000
/config system security cpm-queue queue 35 create
/config system security cpm-queue queue 35 rate 1000 cir 1000
->

<- system_cpu_protection
/config system security cpu-protection policy 1 create
/config system security cpu-protection policy 2 create
/config system security cpu-protection policy 2 description "Customer facing interfaces"
/config system security cpu-protection policy 3 create
/config system security cpu-protection policy 3 description "Core facing interfaces"
/config system security cpu-protection policy 4 create
/config system security cpu-protection policy 4 description "Consumer MSAP policy"
/config system security cpu-protection policy 4 overall-rate 30
/config system security cpu-protection policy 4 per-source-rate 25
/config system security cpu-protection policy 5 create
/config system security cpu-protection policy 5 description "Consumer Capture SAP policy"
/config system security cpu-protection policy 5 overall-rate 100
/config system security cpu-protection policy 5 per-source-rate 50
/config system security cpu-protection policy 5 out-profile-rate 5
/config system security cpu-protection policy 91 create
/config system security cpu-protection policy 91 description "CES TELUS Internal"
/config system security cpu-protection policy 91 eth-cfm entry 10 levels 0-4 opcodes 3,5 rate 10
/config system security cpu-protection policy 91 eth-cfm entry 20 levels 0-4 opcodes 0-255 rate 20
/config system security cpu-protection policy 91 eth-cfm entry 30 levels 0-5 opcodes 0-255 rate 20
/config system security cpu-protection policy 91 eth-cfm entry 90 levels 0-7 opcodes 0-255 rate 0
/config system security cpu-protection policy 254 create
/config system security cpu-protection policy 255 create
/config system security cpu-protection policy 255 description "Default (Modifiable) CPU-Protection Policy assigned to network Interfaces"
/config system security cpu-protection protocol-protection
#/config system security cpu-protection port-overall-rate max
/config system security vprn-network-exceptions
->

<- system_security_cpm-filter_ip-filter
/config system security cpm-filter ip-filter entry 100 create
/config system security cpm-filter ip-filter entry 100 action accept
/config system security cpm-filter ip-filter entry 100 description "<< Transport and Loopback Subnets | MPLS >>"
/config system security cpm-filter ip-filter entry 100 match src-ip 204.225.240.0/21
/config system security cpm-filter ip-filter entry 105 create
/config system security cpm-filter ip-filter entry 105 action accept
/config system security cpm-filter ip-filter entry 105 description "<< Transport Subnets | MPLS - L2PE >>"
/config system security cpm-filter ip-filter entry 105 match src-ip 75.154.208.0/20
/config system security cpm-filter ip-filter entry 110 create
/config system security cpm-filter ip-filter entry 110 action accept
/config system security cpm-filter ip-filter entry 110 description "<< Transport Subnets | RE/BE | ESS6 Metro | PQ >>"
/config system security cpm-filter ip-filter entry 110 match src-ip 154.11.46.0/24
/config system security cpm-filter ip-filter entry 150 create
/config system security cpm-filter ip-filter entry 150 action accept
/config system security cpm-filter ip-filter entry 150 description "<< Interface Address Subnets | L2PE/EN | NS >>"
/config system security cpm-filter ip-filter entry 150 match src-ip 154.11.63.112/28
/config system security cpm-filter ip-filter entry 200 create
/config system security cpm-filter ip-filter entry 200 action accept
/config system security cpm-filter ip-filter entry 200 description "<< Interface Address Subnets | Wholesale ADSL VPOP | AB >>"
/config system security cpm-filter ip-filter entry 200 match src-ip 154.11.54.0/23
/config system security cpm-filter ip-filter entry 205 create
/config system security cpm-filter ip-filter entry 205 action accept
/config system security cpm-filter ip-filter entry 205 description "<< Interface Address Subnets | Wholesale ADSL VPOP | National >>"
/config system security cpm-filter ip-filter entry 205 match src-ip 154.11.75.0/24
/config system security cpm-filter ip-filter entry 210 create
/config system security cpm-filter ip-filter entry 210 action accept
/config system security cpm-filter ip-filter entry 210 description "<< Interface Address Subnets | Wholesale ADSL VPOP | National >>"
/config system security cpm-filter ip-filter entry 210 match src-ip 154.11.76.0/22
/config system security cpm-filter ip-filter entry 215 create
/config system security cpm-filter ip-filter entry 215 action accept
/config system security cpm-filter ip-filter entry 215 description "<< Interface Address Subnets | MPLS Tunnel | BC >>"
/config system security cpm-filter ip-filter entry 215 match src-ip 154.11.83.0/24
/config system security cpm-filter ip-filter entry 300 create
/config system security cpm-filter ip-filter entry 300 action accept
/config system security cpm-filter ip-filter entry 300 description "<< Transport Subnets | MR/TR | TELUS TV | BC-AB >>"
/config system security cpm-filter ip-filter entry 300 match src-ip 154.11.22.0/24
/config system security cpm-filter ip-filter entry 305 create
/config system security cpm-filter ip-filter entry 305 action accept
/config system security cpm-filter ip-filter entry 305 description "<< Transport Subnets | MR/TR | TELUS TV | AB >>"
/config system security cpm-filter ip-filter entry 305 match src-ip 154.11.94.128/25
/config system security cpm-filter ip-filter entry 310 create
/config system security cpm-filter ip-filter entry 310 action accept
/config system security cpm-filter ip-filter entry 310 description "<< Transport Subnets | MR/TR | TELUS TV | AB >>"
/config system security cpm-filter ip-filter entry 310 match src-ip 173.182.206.0/24
/config system security cpm-filter ip-filter entry 315 create
/config system security cpm-filter ip-filter entry 315 action accept
/config system security cpm-filter ip-filter entry 315 description "<< Transport Subnets | MR/TR | TELUS TV | BC >>"
/config system security cpm-filter ip-filter entry 315 match src-ip 173.182.209.0/24
/config system security cpm-filter ip-filter entry 320 create
/config system security cpm-filter ip-filter entry 320 action accept
/config system security cpm-filter ip-filter entry 320 description "<< Loopback Subnets | MR/TR | TELUS TV | PQ >>"
/config system security cpm-filter ip-filter entry 320 match src-ip 66.110.172.0/24
/config system security cpm-filter ip-filter entry 325 create
/config system security cpm-filter ip-filter entry 325 action accept
/config system security cpm-filter ip-filter entry 325 description "<< Transport Subnets | MR/TR | TELUS TV | PQ >>"
/config system security cpm-filter ip-filter entry 325 match src-ip 66.110.174.0/24
/config system security cpm-filter ip-filter entry 400 create
/config system security cpm-filter ip-filter entry 400 action accept
/config system security cpm-filter ip-filter entry 400 description "<< Interface Address Subnets | CA/AR/GS Internet Traffic | AB >>"
/config system security cpm-filter ip-filter entry 400 match src-ip 173.182.194.128/26
/config system security cpm-filter ip-filter entry 405 create
/config system security cpm-filter ip-filter entry 405 action accept
/config system security cpm-filter ip-filter entry 405 description "<< Interface Address Subnets | CA/AR/GS Internet Traffic | AB >>"
/config system security cpm-filter ip-filter entry 405 match src-ip 173.182.194.192/26
/config system security cpm-filter ip-filter entry 410 create
/config system security cpm-filter ip-filter entry 410 action accept
/config system security cpm-filter ip-filter entry 410 description "<< Interface Address Subnets | CA/AR/GS Internet Traffic | BC >>"
/config system security cpm-filter ip-filter entry 410 match src-ip 173.182.196.0/24
/config system security cpm-filter ip-filter entry 415 create
/config system security cpm-filter ip-filter entry 415 action accept
/config system security cpm-filter ip-filter entry 415 description "<< Interface Address Subnets | CA/AR/GS Internet Traffic | BC >>"
/config system security cpm-filter ip-filter entry 415 match src-ip 173.182.197.0/24
/config system security cpm-filter ip-filter entry 420 create
/config system security cpm-filter ip-filter entry 420 action accept
/config system security cpm-filter ip-filter entry 420 description "<< Interface Address Subnets | CA/AR/GS Internet Traffic | AB >>"
/config system security cpm-filter ip-filter entry 420 match src-ip 173.182.202.128/25
/config system security cpm-filter ip-filter entry 425 create
/config system security cpm-filter ip-filter entry 425 action accept
/config system security cpm-filter ip-filter entry 425 description "<< Interface Address Subnets | GS | BC >>"
/config system security cpm-filter ip-filter entry 425 match src-ip 204.174.217.0/26
/config system security cpm-filter ip-filter entry 430 create
/config system security cpm-filter ip-filter entry 430 action accept
/config system security cpm-filter ip-filter entry 430 description "<< Interface Address Subnets | AB Internet | AB >>"
/config system security cpm-filter ip-filter entry 430 match src-ip 205.233.111.0/24
/config system security cpm-filter ip-filter entry 500 create
/config system security cpm-filter ip-filter entry 500 action accept
/config system security cpm-filter ip-filter entry 500 description "<< Loopback Subnets | Arbor Servers | AB >>"
/config system security cpm-filter ip-filter entry 500 match src-ip 208.38.16.128/27
/config system security cpm-filter ip-filter entry 510 create
/config system security cpm-filter ip-filter entry 510 action accept
/config system security cpm-filter ip-filter entry 510 description "<< Transport Subnets | Internet Reachable | BC-AB >>"
/config system security cpm-filter ip-filter entry 510 match src-ip 154.11.62.0/24
/config system security cpm-filter ip-filter entry 520 create
/config system security cpm-filter ip-filter entry 520 action accept
/config system security cpm-filter ip-filter entry 520 description "<< Peering | Loopback Subnets | OSS-Lan | National >>"
/config system security cpm-filter ip-filter entry 520 match src-ip 154.11.0.0/20
/config system security cpm-filter ip-filter entry 530 create
/config system security cpm-filter ip-filter entry 530 action accept
/config system security cpm-filter ip-filter entry 530 description "<< Loopback Subnets | BE | ESS6 Metro | PQ >>"
/config system security cpm-filter ip-filter entry 530 match src-ip 154.11.136.0/24
/config system security cpm-filter ip-filter entry 540 create
/config system security cpm-filter ip-filter entry 540 action accept
/config system security cpm-filter ip-filter entry 540 description "<< Loopback Subnets | EN | ON-PQ-NS >>"
/config system security cpm-filter ip-filter entry 540 match src-ip 154.11.218.64/26
/config system security cpm-filter ip-filter entry 550 create
/config system security cpm-filter ip-filter entry 550 action accept
/config system security cpm-filter ip-filter entry 550 description "<< Loopbacks Subnets | MR |  BC >>"
/config system security cpm-filter ip-filter entry 550 match src-ip 209.115.227.0/24
/config system security cpm-filter ip-filter entry 560 create
/config system security cpm-filter ip-filter entry 560 action accept
/config system security cpm-filter ip-filter entry 560 description "<< Loopback Subnets| MR | BC >>"
/config system security cpm-filter ip-filter entry 560 match src-ip 209.115.187.0/24
/config system security cpm-filter ip-filter entry 570 create
/config system security cpm-filter ip-filter entry 570 action accept
/config system security cpm-filter ip-filter entry 570 description "<< Loopback Subnets | MR/TR |TELUS TV | BC>>"
/config system security cpm-filter ip-filter entry 570 match src-ip 209.115.199.0/24
/config system security cpm-filter ip-filter entry 580 create
/config system security cpm-filter ip-filter entry 580 action accept
/config system security cpm-filter ip-filter entry 580 description "<< Loopback Subnets | MR/TR | TELUS TV | BC>>"
/config system security cpm-filter ip-filter entry 580 match src-ip 208.181.113.0/24
/config system security cpm-filter ip-filter entry 590 create
/config system security cpm-filter ip-filter entry 590 action accept
/config system security cpm-filter ip-filter entry 590 description "<< Loopback Subnets | MR/TR | TELUS TV | BC>>"
/config system security cpm-filter ip-filter entry 590 match src-ip 204.225.240.0/24
/config system security cpm-filter ip-filter entry 600 create
/config system security cpm-filter ip-filter entry 600 action accept
/config system security cpm-filter ip-filter entry 600 description "<< Transport Subnets | Converged Edge | BC >>"
/config system security cpm-filter ip-filter entry 600 match src-ip 173.182.212.0/24
/config system security cpm-filter ip-filter entry 605 create
/config system security cpm-filter ip-filter entry 605 action accept
/config system security cpm-filter ip-filter entry 605 description "<< Transport Subnets | Converged Edge | AB >>"
/config system security cpm-filter ip-filter entry 605 match src-ip 173.182.213.0/24
/config system security cpm-filter ip-filter entry 610 create
/config system security cpm-filter ip-filter entry 610 action accept
/config system security cpm-filter ip-filter entry 610 description "<< Transport Subnets | Converged Edge | ON-PQ-NS >>"
/config system security cpm-filter ip-filter entry 610 match src-ip 173.182.207.192/26
/config system security cpm-filter ip-filter entry 700 create
/config system security cpm-filter ip-filter entry 700 action accept
/config system security cpm-filter ip-filter entry 700 description "<< Transport and Loopback Subnets | Converged Edge >>"
/config system security cpm-filter ip-filter entry 700 match src-ip 96.1.208.0/20
/config system security cpm-filter ip-filter entry 705 create
/config system security cpm-filter ip-filter entry 705 action accept
/config system security cpm-filter ip-filter entry 705 description "<< Loopback Subnets | RE/DE | Converged Edge | BC-AB >>"
/config system security cpm-filter ip-filter entry 705 match src-ip 154.11.47.0/24
/config system security cpm-filter ip-filter entry 710 create
/config system security cpm-filter ip-filter entry 710 action accept
/config system security cpm-filter ip-filter entry 710 description "<< Loopback Subnets | RE/DE | Converged Edge | PQ >>"
/config system security cpm-filter ip-filter entry 710 match src-ip 154.11.72.0/23
/config system security cpm-filter ip-filter entry 715 create
/config system security cpm-filter ip-filter entry 715 action accept
/config system security cpm-filter ip-filter entry 715 description "<< Loopback Subnets | Converged Edge | ON >>"
/config system security cpm-filter ip-filter entry 715 match src-ip 173.182.194.96/27
/config system security cpm-filter ip-filter entry 720 create
/config system security cpm-filter ip-filter entry 720 action accept
/config system security cpm-filter ip-filter entry 720 description "<< Transport and Loopback Subnets | Converged Edge >>"
/config system security cpm-filter ip-filter entry 720 match src-ip 96.1.176.0/20
/config system security cpm-filter ip-filter entry 800 create
/config system security cpm-filter ip-filter entry 800 action queue 33
/config system security cpm-filter ip-filter entry 800 description "<< Permit eBGP not sourced from infrastructure >>"
/config system security cpm-filter ip-filter entry 800 match protocol tcp src-port 179 65535
/config system security cpm-filter ip-filter entry 801 create
/config system security cpm-filter ip-filter entry 801 action queue 33
/config system security cpm-filter ip-filter entry 801 description "<< Permit eBGP not sourced from infrastructure >>"
/config system security cpm-filter ip-filter entry 801 match protocol tcp dst-port 179 65535
/config system security cpm-filter ip-filter entry 810 create
/config system security cpm-filter ip-filter entry 810 action queue 34
/config system security cpm-filter ip-filter entry 810 description "<< ICMP traffic >>"
/config system security cpm-filter ip-filter entry 810 match protocol icmp
/config system security cpm-filter ip-filter entry 820 create
/config system security cpm-filter ip-filter entry 820 action queue 35
/config system security cpm-filter ip-filter entry 820 description "<< TCP-syn-DOS >>"
/config system security cpm-filter ip-filter entry 820 match protocol tcp tcp-syn true
/config system security cpm-filter ip-filter entry 825 create
/config system security cpm-filter ip-filter entry 825 action queue 35
/config system security cpm-filter ip-filter entry 825 description "<< TCP-ack-DOS >>"
/config system security cpm-filter ip-filter entry 825 match protocol tcp tcp-ack true
/config system security cpm-filter ip-filter entry 840 create
/config system security cpm-filter ip-filter entry 840 action accept
/config system security cpm-filter ip-filter entry 840 description "<< Permit un-reserved UDP port range >>"
/config system security cpm-filter ip-filter entry 840 match protocol udp dst-port 32768 65535
/config system security cpm-filter ip-filter entry 845 create
/config system security cpm-filter ip-filter entry 845 action accept
/config system security cpm-filter ip-filter entry 845 description "<< Permit un-reserved TCP port range >>"
/config system security cpm-filter ip-filter entry 845 match protocol tcp dst-port 32768 65535
/config system security cpm-filter ip-filter entry 850 create
/config system security cpm-filter ip-filter entry 850 action accept
/config system security cpm-filter ip-filter entry 850 description "<< Permit NTP >>"
/config system security cpm-filter ip-filter entry 850 match protocol tcp dst-port 123 65535
/config system security cpm-filter ip-filter entry 851 create
/config system security cpm-filter ip-filter entry 851 action accept
/config system security cpm-filter ip-filter entry 851 description "<< Permit NTP >>"
/config system security cpm-filter ip-filter entry 851 match protocol udp dst-port 123 65535
/config system security cpm-filter ip-filter entry 880 create
/config system security cpm-filter ip-filter entry 880 action accept
/config system security cpm-filter ip-filter entry 880 description "<< LSP Ping >>"
/config system security cpm-filter ip-filter entry 880 match protocol udp dst-port 3503 65535
/config system security cpm-filter ip-filter entry 890 create
/config system security cpm-filter ip-filter entry 890 action accept
/config system security cpm-filter ip-filter entry 890 description "<< Permit IGMP >>"
/config system security cpm-filter ip-filter entry 890 match protocol igmp
/config system security cpm-filter ip-filter entry 895 create
r</config system security cpm-filter ip-filter entry 895 action (?:accept|queue 34)>
/config system security cpm-filter ip-filter entry 895 description "<< Permit VRRP >>"
/config system security cpm-filter ip-filter entry 895 match protocol vrrp
/config system security cpm-filter ip-filter entry 896 create
/config system security cpm-filter ip-filter entry 896 action queue 33
/config system security cpm-filter ip-filter entry 896 description "<< Permit BFD Control Packets - TCP >>"
/config system security cpm-filter ip-filter entry 896 match protocol tcp dst-port 3784 65535
/config system security cpm-filter ip-filter entry 897 create
/config system security cpm-filter ip-filter entry 897 action queue 33
/config system security cpm-filter ip-filter entry 897 description "<< Permit BFD Control Packets - UDP >>"
/config system security cpm-filter ip-filter entry 897 match protocol udp dst-port 3784 65535
/config system security cpm-filter ip-filter entry 898 create
/config system security cpm-filter ip-filter entry 898 action queue 33
/config system security cpm-filter ip-filter entry 898 description "<< Permit BFD Echo Packets - TCP >>"
/config system security cpm-filter ip-filter entry 898 match protocol tcp dst-port 3785 65535
/config system security cpm-filter ip-filter entry 899 create
/config system security cpm-filter ip-filter entry 899 action queue 33
/config system security cpm-filter ip-filter entry 899 description "<< Permit BFD Echo Packets - UDP >>"
/config system security cpm-filter ip-filter entry 899 match protocol udp dst-port 3785 65535
/config system security cpm-filter ip-filter entry 905 create
/config system security cpm-filter ip-filter entry 905 action accept
/config system security cpm-filter ip-filter entry 905 description "<< DHCP traffic >>"
/config system security cpm-filter ip-filter entry 905 match protocol udp dst-port 67 65535
/config system security cpm-filter ip-filter entry 910 create
/config system security cpm-filter ip-filter entry 910 action accept
/config system security cpm-filter ip-filter entry 910 description "<< DHCP traffic EDTN >>"
/config system security cpm-filter ip-filter entry 910 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 910 match protocol udp src-ip 173.182.207.80/28
/config system security cpm-filter ip-filter entry 915 create
/config system security cpm-filter ip-filter entry 915 action accept
/config system security cpm-filter ip-filter entry 915 description "<< DHCP traffic CLGR >>"
/config system security cpm-filter ip-filter entry 915 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 915 match protocol udp src-ip 173.182.207.112/28
/config system security cpm-filter ip-filter entry 920 create
/config system security cpm-filter ip-filter entry 920 action accept
/config system security cpm-filter ip-filter entry 920 description "<< DHCP traffic VANC >>"
/config system security cpm-filter ip-filter entry 920 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 920 match protocol udp src-ip 173.182.207.16/28
/config system security cpm-filter ip-filter entry 925 create
/config system security cpm-filter ip-filter entry 925 action accept
/config system security cpm-filter ip-filter entry 925 description "<< DHCP traffic NWMR >>"
/config system security cpm-filter ip-filter entry 925 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 925 match protocol udp src-ip 173.182.207.48/28
/config system security cpm-filter ip-filter entry 926 create
/config system security cpm-filter ip-filter entry 926 action accept
/config system security cpm-filter ip-filter entry 926 description "<< DHCP traffic Mediaroom >>"
/config system security cpm-filter ip-filter entry 926 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 926 match protocol udp src-ip 172.21.0.0/16
/config system security cpm-filter ip-filter entry 927 create
/config system security cpm-filter ip-filter entry 927 action accept
/config system security cpm-filter ip-filter entry 927 description "<< DHCP traffic Rimouski>>"
/config system security cpm-filter ip-filter entry 927 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 927 match protocol udp src-ip 96.1.176.0/28
/config system security cpm-filter ip-filter entry 928 create
/config system security cpm-filter ip-filter entry 928 action accept
/config system security cpm-filter ip-filter entry 928 description "<< DHCP traffic Toronto>>"
/config system security cpm-filter ip-filter entry 928 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 928 match protocol udp src-ip 96.1.176.64/28
/config system security cpm-filter ip-filter entry 929 create
/config system security cpm-filter ip-filter entry 929 action drop
/config system security cpm-filter ip-filter entry 929 description "<< drop non TELUS dhcp traffic >>"
/config system security cpm-filter ip-filter entry 929 match protocol udp dst-port 68 65535
/config system security cpm-filter ip-filter entry 930 create
/config system security cpm-filter ip-filter entry 930 action accept
/config system security cpm-filter ip-filter entry 930 description "<< RADIUS authentication EDTN >>"
/config system security cpm-filter ip-filter entry 930 match protocol udp src-ip 173.182.207.80/28
/config system security cpm-filter ip-filter entry 930 match protocol udp src-port 1812 65535
/config system security cpm-filter ip-filter entry 935 create
/config system security cpm-filter ip-filter entry 935 action accept
/config system security cpm-filter ip-filter entry 935 description "<< RADIUS authentication CLGR >>"
/config system security cpm-filter ip-filter entry 935 match protocol udp src-ip 173.182.207.112/28
/config system security cpm-filter ip-filter entry 935 match protocol udp src-port 1812 65535
/config system security cpm-filter ip-filter entry 940 create
/config system security cpm-filter ip-filter entry 940 action accept
/config system security cpm-filter ip-filter entry 940 description "<< RADIUS authentication VANC >>"
/config system security cpm-filter ip-filter entry 940 match protocol udp src-ip 173.182.207.16/28
/config system security cpm-filter ip-filter entry 940 match protocol udp src-port 1812 65535
/config system security cpm-filter ip-filter entry 945 create
/config system security cpm-filter ip-filter entry 945 action accept
/config system security cpm-filter ip-filter entry 945 description "<< RADIUS authentication NWMR >>"
/config system security cpm-filter ip-filter entry 945 match protocol udp src-ip 173.182.207.48/28
/config system security cpm-filter ip-filter entry 945 match protocol udp src-port 1812 65535
/config system security cpm-filter ip-filter entry 946 create
/config system security cpm-filter ip-filter entry 946 action accept
/config system security cpm-filter ip-filter entry 946 description "<< Radius Authentication Rimouski>>"
/config system security cpm-filter ip-filter entry 946 match protocol udp src-ip 96.1.176.0/28
/config system security cpm-filter ip-filter entry 946 match protocol udp src-port 1812 65535
/config system security cpm-filter ip-filter entry 947 create
/config system security cpm-filter ip-filter entry 947 action accept
/config system security cpm-filter ip-filter entry 947 description "<< Radius Authentication Toronto>>"
/config system security cpm-filter ip-filter entry 947 match protocol udp src-ip 96.1.176.64/28
/config system security cpm-filter ip-filter entry 947 match protocol udp src-port 1812 65535
/config system security cpm-filter ip-filter entry 950 create
/config system security cpm-filter ip-filter entry 950 action accept
/config system security cpm-filter ip-filter entry 950 description "<< RADIUS accounting EDTN >>"
/config system security cpm-filter ip-filter entry 950 match protocol udp src-ip 173.182.207.80/28
/config system security cpm-filter ip-filter entry 950 match protocol udp src-port 1813 65535
/config system security cpm-filter ip-filter entry 955 create
/config system security cpm-filter ip-filter entry 955 action accept
/config system security cpm-filter ip-filter entry 955 description "<< RADIUS accounting CLGR >>"
/config system security cpm-filter ip-filter entry 955 match protocol udp src-ip 173.182.207.112/28
/config system security cpm-filter ip-filter entry 955 match protocol udp src-port 1813 65535
/config system security cpm-filter ip-filter entry 960 create
/config system security cpm-filter ip-filter entry 960 action accept
/config system security cpm-filter ip-filter entry 960 description "<< RADIUS accounting VANC >>"
/config system security cpm-filter ip-filter entry 960 match protocol udp src-ip 173.182.207.16/28
/config system security cpm-filter ip-filter entry 960 match protocol udp src-port 1813 65535
/config system security cpm-filter ip-filter entry 965 create
/config system security cpm-filter ip-filter entry 965 action accept
/config system security cpm-filter ip-filter entry 965 description "<< RADIUS accounting NWMR >>"
/config system security cpm-filter ip-filter entry 965 match protocol udp src-ip 173.182.207.48/28
/config system security cpm-filter ip-filter entry 965 match protocol udp src-port 1813 65535
/config system security cpm-filter ip-filter entry 966 create
/config system security cpm-filter ip-filter entry 966 action accept
/config system security cpm-filter ip-filter entry 966 description "<< Radius Accounting Rimouski>>"
/config system security cpm-filter ip-filter entry 966 match protocol udp src-ip 96.1.176.0/28
/config system security cpm-filter ip-filter entry 966 match protocol udp src-port 1813 65535
/config system security cpm-filter ip-filter entry 967 create
/config system security cpm-filter ip-filter entry 967 action accept
/config system security cpm-filter ip-filter entry 967 description "<< Radius Accounting Toronto>>"
/config system security cpm-filter ip-filter entry 967 match protocol udp src-ip 96.1.176.64/28
/config system security cpm-filter ip-filter entry 967 match protocol udp src-port 1813 65535
/config system security cpm-filter ip-filter entry 970 create
/config system security cpm-filter ip-filter entry 970 action accept
/config system security cpm-filter ip-filter entry 970 description "<< RADIUS Change of Authorization (CoA) EDTN >>"
/config system security cpm-filter ip-filter entry 970 match protocol udp dst-port 3799 65535
/config system security cpm-filter ip-filter entry 970 match protocol udp src-ip 173.182.207.80/28
/config system security cpm-filter ip-filter entry 975 create
/config system security cpm-filter ip-filter entry 975 action accept
/config system security cpm-filter ip-filter entry 975 description "<< RADIUS Change of Authorization (CoA) CLGR >>"
/config system security cpm-filter ip-filter entry 975 match protocol udp dst-port 3799 65535
/config system security cpm-filter ip-filter entry 975 match protocol udp src-ip 173.182.207.112/28
/config system security cpm-filter ip-filter entry 980 create
/config system security cpm-filter ip-filter entry 980 action accept
/config system security cpm-filter ip-filter entry 980 description "<< RADIUS Change of Authorization (CoA) VANC >>"
/config system security cpm-filter ip-filter entry 980 match protocol udp dst-port 3799 65535
/config system security cpm-filter ip-filter entry 980 match protocol udp src-ip 173.182.207.16/28
/config system security cpm-filter ip-filter entry 985 create
/config system security cpm-filter ip-filter entry 985 action accept
/config system security cpm-filter ip-filter entry 985 description "<< RADIUS Change of Authorization (CoA) NWMR >>"
/config system security cpm-filter ip-filter entry 985 match protocol udp dst-port 3799 65535
/config system security cpm-filter ip-filter entry 985 match protocol udp src-ip 173.182.207.48/28
/config system security cpm-filter ip-filter entry 986 create
/config system security cpm-filter ip-filter entry 986 action accept
/config system security cpm-filter ip-filter entry 986 description "<< Radius Change of Authorization (CoA) Rimouski>>"
/config system security cpm-filter ip-filter entry 986 match protocol udp dst-port 3799 65535
/config system security cpm-filter ip-filter entry 986 match protocol udp src-ip 96.1.176.0/28
/config system security cpm-filter ip-filter entry 987 create
/config system security cpm-filter ip-filter entry 987 action accept
/config system security cpm-filter ip-filter entry 987 description "<< Radius Change of Authorization (CoA) Toronto>>"
/config system security cpm-filter ip-filter entry 987 match protocol udp dst-port 3799 65535
/config system security cpm-filter ip-filter entry 987 match protocol udp src-ip 96.1.176.64/28
/config system security cpm-filter ip-filter entry 1000 create
/config system security cpm-filter ip-filter entry 1000 action queue 33
/config system security cpm-filter ip-filter entry 1000 description "<< Match all TCP - CPM testing Soak Period >>"
/config system security cpm-filter ip-filter entry 1000 match protocol tcp
/config system security cpm-filter ip-filter entry 1001 create
/config system security cpm-filter ip-filter entry 1001 action queue 33
/config system security cpm-filter ip-filter entry 1001 description "<< Match all UDP - CPM testing Soak Period >>"
/config system security cpm-filter ip-filter entry 1001 match protocol udp
/config system security cpm-filter ip-filter no shutdown
->

<-system_security_cpm-filter_ipv6-filter
/config system security cpm-filter ipv6-filter entry 100 create
/config system security cpm-filter ipv6-filter entry 100 action accept
/config system security cpm-filter ipv6-filter entry 100 description "<< TELUS Internal Non-Advertised >>"
r</config system security cpm-filter ipv6-filter entry 100 match src-ip (?:2001:568:F000::/36|2001:568:f000::/36)>
/config system security cpm-filter ipv6-filter entry 800 create
/config system security cpm-filter ipv6-filter entry 800 action queue 33
/config system security cpm-filter ipv6-filter entry 800 description "<< Permit eBGP not sourced from infrastructure >>"
/config system security cpm-filter ipv6-filter entry 800 match next-header tcp src-port 179 65535
/config system security cpm-filter ipv6-filter entry 801 create
/config system security cpm-filter ipv6-filter entry 801 action queue 33
/config system security cpm-filter ipv6-filter entry 801 description "<< Permit eBGP not sourced from infrastructure >>"
/config system security cpm-filter ipv6-filter entry 801 match next-header tcp dst-port 179 65535
/config system security cpm-filter ipv6-filter entry 810 create
/config system security cpm-filter ipv6-filter entry 810 action queue 34
/config system security cpm-filter ipv6-filter entry 810 description "<< ICMP traffic >>"
/config system security cpm-filter ipv6-filter entry 810 match next-header ipv6-icmp
/config system security cpm-filter ipv6-filter entry 820 create
/config system security cpm-filter ipv6-filter entry 820 action queue 35
/config system security cpm-filter ipv6-filter entry 820 description "<< TCP-syn-DOS >>"
/config system security cpm-filter ipv6-filter entry 820 match next-header tcp tcp-syn true
/config system security cpm-filter ipv6-filter entry 825 create
/config system security cpm-filter ipv6-filter entry 825 action queue 35
/config system security cpm-filter ipv6-filter entry 825 description "<< TCP-ack-DOS >>"
/config system security cpm-filter ipv6-filter entry 825 match next-header tcp tcp-ack true
/config system security cpm-filter ipv6-filter entry 840 create
/config system security cpm-filter ipv6-filter entry 840 action accept
/config system security cpm-filter ipv6-filter entry 840 description "<< Permit un-reserved UDP port range >>"
/config system security cpm-filter ipv6-filter entry 840 match next-header udp dst-port 32768 65535
/config system security cpm-filter ipv6-filter entry 845 create
/config system security cpm-filter ipv6-filter entry 845 action accept
/config system security cpm-filter ipv6-filter entry 845 description "<< Permit un-reserved TCP port range >>"
/config system security cpm-filter ipv6-filter entry 845 match next-header tcp dst-port 32768 65535
/config system security cpm-filter ipv6-filter entry 880 create
/config system security cpm-filter ipv6-filter entry 880 action accept
/config system security cpm-filter ipv6-filter entry 880 description "<< LSP Ping >>"
/config system security cpm-filter ipv6-filter entry 880 match next-header udp dst-port 3503 65535
/config system security cpm-filter ipv6-filter entry 896 create
/config system security cpm-filter ipv6-filter entry 896 action queue 33
/config system security cpm-filter ipv6-filter entry 896 description "<< Permit BFD Control Packets - TCP >>"
/config system security cpm-filter ipv6-filter entry 896 match next-header tcp dst-port 3784 65535
/config system security cpm-filter ipv6-filter entry 897 create
/config system security cpm-filter ipv6-filter entry 897 action queue 33
/config system security cpm-filter ipv6-filter entry 897 description "<< Permit BFD Control Packets - UDP >>"
/config system security cpm-filter ipv6-filter entry 897 match next-header udp dst-port 3784 65535
/config system security cpm-filter ipv6-filter entry 898 create
/config system security cpm-filter ipv6-filter entry 898 action queue 33
/config system security cpm-filter ipv6-filter entry 898 description "<< Permit BFD Echo Packets - TCP >>"
/config system security cpm-filter ipv6-filter entry 898 match next-header tcp dst-port 3785 65535
/config system security cpm-filter ipv6-filter entry 899 create
/config system security cpm-filter ipv6-filter entry 899 action queue 33
/config system security cpm-filter ipv6-filter entry 899 description "<< Permit BFD Echo Packets - UDP >>"
/config system security cpm-filter ipv6-filter entry 899 match next-header udp dst-port 3785 65535
/config system security cpm-filter ipv6-filter no shutdown
->

#### define router rules ####
<- port_L2PE_CA_Uplink
<#type=dynamic>
<#instance=/config port (\S+) description ".*?[[:alnum:]](?:CA|PE)\d{2}.*?">
<#instance_condition=/config port i<1> ethernet network>
<#match=any_if_found>
/config port i<1> network egress pool slope-policy "COLOURED-WRED"
/config port i<1> ethernet mtu 9192
#### Feng removed 2015-07-09 ####
#/config port i<1> ethernet egress-scheduler-policy "network-facing-10GE"
/config port i<1> ethernet network queue-policy "network-facing"
/config port i<1> ethernet network accounting-policy 3
/config port i<1> ethernet network collect-stats
/config port i<1> ethernet lldp dest-mac nearest-bridge admin-status tx-rx
/config port i<1> ethernet lldp dest-mac nearest-bridge tx-tlvs port-desc sys-name sys-desc sys-cap
/config port i<1> ethernet lldp dest-mac nearest-bridge tx-mgmt-address system
/config port i<1> ethernet hold-time up 60
#/config port i<1> ethernet report-alarm high-ber
#/config port i<1> no shutdown
->

<- port_DE_Network
<#type=dynamic>
<#instance=/config port (\S+) description ".*?[[:alnum:]]DE\d{2}.*?">
<#instance_condition=/config port i<1> ethernet network>
<#match=any_if_found>
/config port i<1> network egress pool slope-policy "COLOURED-WRED"
/config port i<1> ethernet mtu 9192
#/config port i<1> ethernet egress-scheduler-policy "DE-RE-facing-GE"
/config port i<1> ethernet network queue-policy "network-facing"
/config port i<1> ethernet network accounting-policy 3
/config port i<1> ethernet network collect-stats
/config port i<1> ethernet lldp dest-mac nearest-bridge admin-status tx-rx
/config port i<1> ethernet lldp dest-mac nearest-bridge tx-tlvs port-desc sys-name sys-desc sys-cap
/config port i<1> ethernet lldp dest-mac nearest-bridge tx-mgmt-address system
/config port i<1> ethernet hold-time up 60
#/config port i<1> no shutdown
->

<- port_GPON
<#type=dynamic>
<#instance=/config port (\S+) description ".*?[[:alnum:]]{8}OT\d{2}.*?">
<#instance_condition=/config port i<1> ethernet mode access>
<#match=any_if_found>
/config port i<1> ethernet mode access
/config port i<1> ethernet encap-type dot1q
r</config port i<1> ethernet egress-scheduler-policy (?:"AccessEgress-10GE"|"AccessEgress-GE")>
->

<- port_DSLAM
<#type=dynamic>
<#match=any_if_found>
<#instance=/config port (\S+) description ".*?[[:alnum:]]{8,11}DS\d{2}.*?">
<#instance_condition=/config port i<1> ethernet mode access>
/config port i<1> ethernet mode access
/config port i<1> ethernet encap-type dot1q
/config port i<1> ethernet egress-scheduler-policy "AccessEgress-GE"
->

<- lag_GPON
<#type=dynamic>
<#instance=/config lag (\d+) description ".*?[[:alnum:]]{8}OT\d{2}.*?">
<#instance_condition=/config lag i<1> mode access>
<#match=any_if_found>
/config lag i<1> mode access
/config lag i<1> encap-type dot1q
/config lag i<1> access adapt-qos link
r</config lag i<1> lacp active>
/config lag i<1> lacp-xmit-interval slow
->

<- lag_DSLAM
<#type=dynamic>
<#instance=/config lag (\d+) description ".*?[[:alnum:]]{8,11}DS\d{2}.*?">
<#instance_condition=/config lag i<1> mode access>
<#match=any_if_found>
/config lag i<1> mode access
/config lag i<1> encap-type dot1q
#/config lag i<1> access adapt-qos link
r</config lag i<1> lacp active>
/config lag i<1> lacp-xmit-interval slow
->

<- lag_CA_MicroBFD
<#type=dynamic>
<#instance=/config lag (\d+) description ".*?[[:alnum:]]{8}(?:CA|PE)\d{2}.*?">
#below is a negative regex, if it is radio link, do not config micro-bfd
<#instance_condition=/config lag i<1> description "(?:(?!Radio).)*?">
<#match=any_if_found>
#/config lag i<1> encap-type dot1q
#r</config lag i<1> lacp active>
#/config lag i<1> lacp-xmit-interval slow
/config lag i<1> bfd family ipv4 receive-interval 10
/config lag i<1> bfd family ipv4 transmit-interval 10
r</config lag i<1> bfd family ipv4 local-ip-address \w{1,3}\.\w{1,3}\.\w{1,3}\.\w{1,3}>
r</config lag i<1> bfd family ipv4 remote-ip-address \w{1,3}\.\w{1,3}\.\w{1,3}\.\w{1,3}>
/config lag i<1> bfd family ipv4 no shutdown
/config lag i<1> no shutdown
->

<- router_mpls_color
<#condition=get_version=TiMOS-C-13.0.R10>
/config router if-attribute admin-group "GSR-LINK" value 3
/config router if-attribute admin-group "INTER-LINK" value 5
/config router if-attribute admin-group "NORTH-ROUTE" value 1
/config router if-attribute admin-group "SOUTH-ROUTE" value 2
/config router if-attribute admin-group "US-LINK" value 4
->

<- router_mpls_color
<#condition=get_version=TiMOS-C-11.0.R12>
/config router mpls admin-group "GSR-LINK" 3
/config router mpls admin-group "INTER-LINK" 5
/config router mpls admin-group "NORTH-ROUTE" 1
/config router mpls admin-group "SOUTH-ROUTE" 2
/config router mpls admin-group "US-LINK" 4
->


<- router_global
/config router autonomous-system 852
/config router ecmp 4
/config router ip-fast-reroute
/config router static-route 0.0.0.0/0 black-hole
/config router static-route 154.11.0.255/32 black-hole
/config router sgt-qos application bgp dscp nc2
/config router sgt-qos application cflowd dscp cs2
/config router sgt-qos application dhcp dscp cs2
/config router sgt-qos application dns dscp cs2
/config router sgt-qos application ftp dscp cs2
/config router sgt-qos application icmp dscp be
/config router sgt-qos application igmp dscp nc2
/config router sgt-qos application ldp dscp nc2
/config router sgt-qos application mld dscp nc2
/config router sgt-qos application msdp dscp nc2
/config router sgt-qos application ndis dscp nc2
/config router sgt-qos application ntp dscp cs2
/config router sgt-qos application ospf dscp nc2
/config router sgt-qos application pim dscp nc2
/config router sgt-qos application radius dscp cs2
/config router sgt-qos application rip dscp nc2
/config router sgt-qos application rsvp dscp nc2
/config router sgt-qos application snmp dscp cs2
/config router sgt-qos application snmp-notification dscp cs2
/config router sgt-qos application srrp dscp nc2
/config router sgt-qos application ssh dscp cs2
/config router sgt-qos application syslog dscp cs2
/config router sgt-qos application tacplus dscp cs2
/config router sgt-qos application telnet dscp cs2
/config router sgt-qos application tftp dscp cs2
/config router sgt-qos application traceroute dscp be
/config router sgt-qos application vrrp dscp nc2
/config router sgt-qos application arp dot1p 7
/config router sgt-qos application isis dot1p 7
/config router sgt-qos application pppoe dot1p 7
/config router sgt-qos dscp cs2 fc l1
/config router static-route ::/0 black-hole
/config router static-route ::ffff:154.11.0.255/128 black-hole
/config router static-route 2001:568:f000::1/128 black-hole
->

<- router_interface_system
/config router interface "system" icmp no mask-reply
/config router interface "system" icmp no redirects
r</config router isis(?: 0)? interface "system" level-capability level-2>
r</config router isis(?: 0)? interface "system" passive>
r</config router isis(?: 0)? interface "system" no shutdown>
/config router mpls interface "system" no shutdown
/config router rsvp interface "system" no shutdown
->


<- router_interface_uplink
<#type=dynamic>
<#match=any_if_found>
<#instance=/config router interface ("[[:alnum:]]{8}(?:CA|PE|RE)\d{2}") address>
r</config router interface i<1> address \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/\d{2}>
#r</config router interface i<1> description ".+?">
/config router interface i<1> enable-ingress-stats
#/config router interface i<1> urpf-check mode loose
#/config router interface i<1> ipv6 urpf-check mode loose
/config router interface i<1> ldp-sync-timer 15
r</config router interface i<1> port lag-\d{1,3}:100>
/config router interface i<1> icmp no mask-reply
/config router interface i<1> icmp no redirects
r</config router interface i<1> qos (?:218|230|231)>
#/config router interface i<1> cflowd interface
/config router interface i<1> bfd 100 receive 100 multiplier 3
->


<- router_interface_DE
<#type=dynamic>
<#instance=/config router interface ("[[:alnum:]]{8}DE\d{2}") address>
<#match=any_if_found>
r</config router interface i<1> address \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}/\d{2}>
r</config router interface i<1> description ".+?">
/config router interface i<1> enable-ingress-stats
#/config router interface i<1> urpf-check mode loose
#/config router interface i<1> ipv6 urpf-check mode loose
/config router interface i<1> ldp-sync-timer 15
r</config router interface i<1> port lag-\d{1,3}:100>
/config router interface i<1> icmp no mask-reply
/config router interface i<1> icmp no redirects
/config router interface i<1> qos 231
#/config router interface i<1> cflowd interface
r</config router interface i<1> bfd (100|300) receive (100|300) multiplier 3>
->


#Feng removed, not important
#<- router_interface_no_unreachables_removed
#<#type=dynamic>
#<#instance=/config router interface (".+?") address> 
#<#match=none_if_found>
#/config router interface i<1> icmp no unreachables
#->

<- router_isis_global
#r</config router isis(?: 0)? level-capability level-2>
r</config router isis(?: 0)? area-id \d{2}\.\d{4}>
r</config router isis(?: 0)? lsp-lifetime 65535>
#r</config router isis(?: 0)? lsp-refresh-interval 32767>
r</config router isis(?: 0)? overload-on-boot timeout 260>
r</config router isis(?: 0)? traffic-engineering>
r</config router isis(?: 0)? advertise-passive-only>
r</config router isis(?: 0)? loopfree-alternate>
r</config router isis(?: 0)? spf-wait 1 10 50>
r</config router isis(?: 0)? level 2 wide-metrics-only>
->


<- router_isis_interface
<#type=dynamic>
<#instance=/config router interface ("[[:alnum:]]{8}(?:CA|PE|RE)\d{2}") address>
<#match=any_if_found>
r</config router isis(?: 0)? interface i<1> level-capability level-2>
r</config router isis(?: 0)? interface i<1> interface-type point-to-point>
r</config router isis(?: 0)? interface i<1> bfd-enable ipv4>
r</config router isis(?: 0)? interface i<1> level 2 hello-authentication-key ".+?" hash2>
r</config router isis(?: 0)? interface i<1> level 2 hello-authentication-type (message-digest|password)>
r</config router isis(?: 0)? interface i<1> level 2 hello-interval 5>
#/config router isis(?: 0)? interface i<1> level 2 metric 10000
->

<- router_isis_interface_DE
<#type=dynamic>
<#instance=/config router interface ("[[:alnum:]]{8}DE\d{2}") address>
<#match=any_if_found>
r</config router isis(?: 0)? interface i<1> level-capability level-2>
r</config router isis(?: 0)? interface i<1> interface-type point-to-point>
r</config router isis(?: 0)? interface i<1> bfd-enable ipv4>
r</config router isis(?: 0)? interface i<1> level 2 hello-authentication-key ".+?" hash2>
r</config router isis(?: 0)? interface i<1> level 2 hello-authentication-type (message-digest|password)>
r</config router isis(?: 0)? interface i<1> level 2 hello-interval 5>
r</config router isis(?: 0)? interface i<1> level 2 metric 100000>
->


<- router_igmp_query-interval
/config router igmp query-interval 30
->


<- router_pim_global
/config router pim rp static
/config router pim rp bsr-candidate shutdown
/config router pim rp rp-candidate shutdown
/config router pim mc-ecmp-balance-hold 480
/config router pim multicast-fast-failover
->


<- router_pim_interface
<#type=dynamic>
<#instance=/config router pim interface ("[[:alnum:]]{8}(?:CA|PE|RE)\d{2}")>
<#match=any_if_found>
/config router pim interface i<1> bfd-enable
->


<- router_mpls_global
/config router mpls path "P_PATH" no shutdown
/config router mpls path "DYNAMIC" no shutdown
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp default-path "P_PATH"
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp cspf
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp include "INTER-LINK"
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp include "NORTH-ROUTE"
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp include "SOUTH-ROUTE"
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp exclude "GSR-LINK"
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp bandwidth 1
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp retry-timer 10
/config router mpls lsp-template "s<HOSTNAME>_P2MP" p2mp no shutdown
/config router mpls least-fill-reoptim-thd 5
/config router mpls p2mp-resignal-timer 600
/config router mpls no shutdown
->


<- router_mpls_interface
<#type=dynamic>
<#instance=/config router interface ("[[:alnum:]]{8}(?:CA|PE|RE)\d{2}")>
<#match=any_if_found>
r</config router mpls interface i<1> admin-group "\S+">
->

<- router_ldp_global
/config router ldp no shortcut-transit-ttl-propagate
/config router ldp targeted-session
/config router ldp fast-reroute
->


<- router_ldp_interface
<#type=dynamic>
<#instance=/config router interface "([[:alnum:]]{8}(?:CA|PE|RE)\d{2})">
<#match=any_if_found>
r</config router ldp interface-parameters interface "i<1>"(?: dual-stack)? bfd-enable(?: ipv4)?>
->


<- router_bgp_global
/config router bgp enable-peer-tracking
/config router bgp multipath 2
/config router bgp ibgp-multipath
/config router bgp rapid-withdrawal
/config router bgp local-as 852
/config router bgp rapid-update l2-vpn mvpn-ipv4
->

<- router_bgp_shortcut_SROS11
<#condition=get_version=(TiMOS-C-11.0.R18|TiMOS-C-11.0.R12)>
/config router bgp igp-shortcut mpls
->

<- router_bgp_shortcut_SROS13
<#condition=get_version=TiMOS-C-13.0.R10>
/config router bgp next-hop-resolution shortcut-tunnel family ipv4 resolution-filter ldp
/config router bgp next-hop-resolution shortcut-tunnel family ipv4 resolution-filter rsvp
/config router bgp next-hop-resolution shortcut-tunnel family ipv4 resolution filter
->

<- router_bgp_router-id
<#type=dynamic>
<#instance=/config router interface "system" address (\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\/32>
/config router bgp router-id i<1>
->


#<- router_bgp_group_CUSTOMER-FULL
#/config router bgp group "CUSTOMER-FULL" hold-time 90 min 45
#/config router bgp group "CUSTOMER-FULL" keepalive 60
#->


#<- router_bgp_group_CUSTOMER-DEFAULT
#/config router bgp group "CUSTOMER-DEFAULT" hold-time 90 min 45
#/config router bgp group "CUSTOMER-DEFAULT" keepalive 60
#->


<- router_bgp_group_ROUTE-REFLECTOR-JCS
/config router bgp group "ROUTE-REFLECTOR-JCS" next-hop-self
/config router bgp group "ROUTE-REFLECTOR-JCS" import "RE-IMPORT-IPV4-s<HOSTNAME>" "RE-IMPORT-IPV6-s<HOSTNAME>"
/config router bgp group "ROUTE-REFLECTOR-JCS" export "RE-EXPORT-IPV4-s<HOSTNAME>" "RE-EXPORT-IPV6-s<HOSTNAME>"
/config router bgp group "ROUTE-REFLECTOR-JCS" peer-as 852
/config router bgp group "ROUTE-REFLECTOR-JCS" min-route-advertisement 5
->


#### define QoS rules ####
<-get_province
<#type=get_parameter>
^/config system name "\w{4}(\w{2})\w{4}\d{2}"
->

<- qos_network-queue_network-facing
/config qos network-queue "network-facing" create
/config qos network-queue "network-facing" queue 1 create
/config qos network-queue "network-facing" queue 1 port-parent weight 50 cir-level 1 cir-weight 50
/config qos network-queue "network-facing" queue 1 rate 100 cir 100
/config qos network-queue "network-facing" queue 1 mbs 50
/config qos network-queue "network-facing" queue 1 high-prio-only 10
/config qos network-queue "network-facing" queue 2 create
/config qos network-queue "network-facing" queue 2 port-parent level 2 weight 13 cir-level 2 cir-weight 13
/config qos network-queue "network-facing" queue 2 rate 100 cir 100
/config qos network-queue "network-facing" queue 2 mbs 50
/config qos network-queue "network-facing" queue 2 cbs 3
/config qos network-queue "network-facing" queue 2 high-prio-only 10
/config qos network-queue "network-facing" queue 3 create
/config qos network-queue "network-facing" queue 3 port-parent level 2 weight 21 cir-level 2 cir-weight 21
/config qos network-queue "network-facing" queue 3 rate 100 cir 100
/config qos network-queue "network-facing" queue 3 mbs 50
/config qos network-queue "network-facing" queue 3 cbs 10
/config qos network-queue "network-facing" queue 3 high-prio-only 10
/config qos network-queue "network-facing" queue 4 create
/config qos network-queue "network-facing" queue 4 port-parent level 2 weight 66 cir-level 2 cir-weight 66
/config qos network-queue "network-facing" queue 4 rate 100 cir 100
/config qos network-queue "network-facing" queue 4 mbs 25
/config qos network-queue "network-facing" queue 4 cbs 3
/config qos network-queue "network-facing" queue 4 high-prio-only 10
/config qos network-queue "network-facing" queue 5 create
/config qos network-queue "network-facing" queue 5 port-parent level 3 weight 50 cir-level 3 cir-weight 50
/config qos network-queue "network-facing" queue 5 rate 100 cir 100
/config qos network-queue "network-facing" queue 5 mbs 2
/config qos network-queue "network-facing" queue 5 cbs 2
/config qos network-queue "network-facing" queue 5 high-prio-only 10
/config qos network-queue "network-facing" queue 6 create
/config qos network-queue "network-facing" queue 6 port-parent level 4 weight 50 cir-level 4 cir-weight 50
/config qos network-queue "network-facing" queue 6 rate 100 cir 100
/config qos network-queue "network-facing" queue 6 mbs 1
/config qos network-queue "network-facing" queue 6 high-prio-only 10
/config qos network-queue "network-facing" queue 7 create
/config qos network-queue "network-facing" queue 7 port-parent level 5 weight 50 cir-level 5 cir-weight 50
/config qos network-queue "network-facing" queue 7 rate 100 cir 100
/config qos network-queue "network-facing" queue 7 mbs 1
/config qos network-queue "network-facing" queue 7 high-prio-only 10
/config qos network-queue "network-facing" queue 8 create
/config qos network-queue "network-facing" queue 8 port-parent level 6 weight 50 cir-level 6 cir-weight 50
/config qos network-queue "network-facing" queue 8 rate 100 cir 100
/config qos network-queue "network-facing" queue 8 mbs 1
/config qos network-queue "network-facing" queue 8 high-prio-only 10
/config qos network-queue "network-facing" queue 9 multipoint create
/config qos network-queue "network-facing" queue 9 multipoint mbs 50
/config qos network-queue "network-facing" queue 9 multipoint high-prio-only 10
/config qos network-queue "network-facing" queue 10 multipoint create
/config qos network-queue "network-facing" queue 10 multipoint high-prio-only 10
/config qos network-queue "network-facing" queue 11 multipoint create
/config qos network-queue "network-facing" queue 11 multipoint high-prio-only 10
/config qos network-queue "network-facing" queue 12 multipoint create
/config qos network-queue "network-facing" queue 12 multipoint high-prio-only 10
/config qos network-queue "network-facing" queue 13 multipoint create
/config qos network-queue "network-facing" queue 13 multipoint high-prio-only 10
/config qos network-queue "network-facing" queue 14 multipoint create
/config qos network-queue "network-facing" queue 14 multipoint port-parent level 4 weight 50 cir-level 4 cir-weight 50
/config qos network-queue "network-facing" queue 14 multipoint rate 100 cir 100
/config qos network-queue "network-facing" queue 14 multipoint mbs 1
/config qos network-queue "network-facing" queue 14 multipoint high-prio-only 10
/config qos network-queue "network-facing" queue 15 multipoint create
/config qos network-queue "network-facing" queue 15 multipoint high-prio-only 10
/config qos network-queue "network-facing" queue 16 multipoint create
/config qos network-queue "network-facing" queue 16 multipoint high-prio-only 10
/config qos network-queue "network-facing" fc af create
/config qos network-queue "network-facing" fc af multicast-queue 11
/config qos network-queue "network-facing" fc af queue 3
/config qos network-queue "network-facing" fc be create
/config qos network-queue "network-facing" fc be multicast-queue 9
/config qos network-queue "network-facing" fc be queue 1
/config qos network-queue "network-facing" fc ef create
/config qos network-queue "network-facing" fc ef multicast-queue 14
/config qos network-queue "network-facing" fc ef queue 6
/config qos network-queue "network-facing" fc h1 create
/config qos network-queue "network-facing" fc h1 multicast-queue 15
/config qos network-queue "network-facing" fc h1 queue 7
/config qos network-queue "network-facing" fc h2 create
/config qos network-queue "network-facing" fc h2 multicast-queue 13
/config qos network-queue "network-facing" fc h2 queue 5
/config qos network-queue "network-facing" fc l1 create
/config qos network-queue "network-facing" fc l1 multicast-queue 12
/config qos network-queue "network-facing" fc l1 queue 4
/config qos network-queue "network-facing" fc l2 create
/config qos network-queue "network-facing" fc l2 multicast-queue 10
/config qos network-queue "network-facing" fc l2 queue 2
/config qos network-queue "network-facing" fc nc create
/config qos network-queue "network-facing" fc nc multicast-queue 16
/config qos network-queue "network-facing" fc nc queue 8
->

<- qos_port-scheduler-policy_AccessEgress-10GE
/config qos port-scheduler-policy "AccessEgress-10GE" create
/config qos port-scheduler-policy "AccessEgress-10GE" description "Access port Scheduler Policy GE port"
/config qos port-scheduler-policy "AccessEgress-10GE" level 1 rate max cir 10000
/config qos port-scheduler-policy "AccessEgress-10GE" level 2 rate max cir 500000
/config qos port-scheduler-policy "AccessEgress-10GE" level 3 rate max cir 1000000
/config qos port-scheduler-policy "AccessEgress-10GE" level 4 rate max cir 8000000
/config qos port-scheduler-policy "AccessEgress-10GE" level 5 rate max cir 1000000
/config qos port-scheduler-policy "AccessEgress-10GE" level 6 rate max cir 2000000
/config qos port-scheduler-policy "AccessEgress-10GE" level 7 rate max cir 100000
/config qos port-scheduler-policy "AccessEgress-10GE" level 8 rate max cir 100000
->

<- qos_port-scheduler-policy_AccessEgress-GE
/config qos port-scheduler-policy "AccessEgress-GE" create
/config qos port-scheduler-policy "AccessEgress-GE" description "Access port Scheduler Policy GE port"
/config qos port-scheduler-policy "AccessEgress-GE" level 1 rate max cir 1000
/config qos port-scheduler-policy "AccessEgress-GE" level 2 rate max cir 50000
/config qos port-scheduler-policy "AccessEgress-GE" level 3 rate max cir 100000
/config qos port-scheduler-policy "AccessEgress-GE" level 4 rate max cir 500000
/config qos port-scheduler-policy "AccessEgress-GE" level 5 rate max cir 100000
/config qos port-scheduler-policy "AccessEgress-GE" level 6 rate max cir 800000
/config qos port-scheduler-policy "AccessEgress-GE" level 7 rate max cir 10000
/config qos port-scheduler-policy "AccessEgress-GE" level 8 rate max cir 10000
->

<- qos_port-scheduler-policy_DE-RE-facing-10GE
/config qos port-scheduler-policy "DE-RE-facing-10GE" create
/config qos port-scheduler-policy "DE-RE-facing-10GE" description "Scheduler policy for DE-RE 10GE network ports"
/config qos port-scheduler-policy "DE-RE-facing-10GE" level 1 rate max cir 500000
/config qos port-scheduler-policy "DE-RE-facing-10GE" level 2 rate max cir 1500000
/config qos port-scheduler-policy "DE-RE-facing-10GE" level 3 rate max cir 3000000
/config qos port-scheduler-policy "DE-RE-facing-10GE" level 4 rate max cir 3500000
/config qos port-scheduler-policy "DE-RE-facing-10GE" level 5 rate max cir 1000000
/config qos port-scheduler-policy "DE-RE-facing-10GE" level 6 rate 500000 cir 500000
->

<- qos_port-scheduler-policy_DE-RE-facing-GE
/config qos port-scheduler-policy "DE-RE-facing-GE" create
/config qos port-scheduler-policy "DE-RE-facing-GE" description "Scheduler policy for DE-RE network ports"
/config qos port-scheduler-policy "DE-RE-facing-GE" level 1 rate max cir 50000
/config qos port-scheduler-policy "DE-RE-facing-GE" level 2 rate max cir 200000
/config qos port-scheduler-policy "DE-RE-facing-GE" level 3 rate max cir 300000
/config qos port-scheduler-policy "DE-RE-facing-GE" level 4 rate max cir 500000
/config qos port-scheduler-policy "DE-RE-facing-GE" level 5 rate max cir 100000
/config qos port-scheduler-policy "DE-RE-facing-GE" level 6 rate 50000 cir 50000
->

<- qos_port-scheduler-policy_network-facing-10GE
/config qos port-scheduler-policy "network-facing-10GE" create
/config qos port-scheduler-policy "network-facing-10GE" description "Scheduler policy for 10GE core network ports"
/config qos port-scheduler-policy "network-facing-10GE" level 1 rate max cir 500000
/config qos port-scheduler-policy "network-facing-10GE" level 2 rate max cir 1500000
/config qos port-scheduler-policy "network-facing-10GE" level 3 rate max cir 3000000
/config qos port-scheduler-policy "network-facing-10GE" level 4 rate max cir 3500000
/config qos port-scheduler-policy "network-facing-10GE" level 5 rate max cir 1000000
/config qos port-scheduler-policy "network-facing-10GE" level 6 rate 500000 cir 500000
->

<- qos_port-scheduler-policy_network-facing-GE
/config qos port-scheduler-policy "network-facing-GE" description "Scheduler policy for GE core network ports"
/config qos port-scheduler-policy "network-facing-GE" level 1 rate max cir 50000
/config qos port-scheduler-policy "network-facing-GE" level 2 rate max cir 200000
/config qos port-scheduler-policy "network-facing-GE" level 3 rate max cir 300000
/config qos port-scheduler-policy "network-facing-GE" level 4 rate max cir 500000
/config qos port-scheduler-policy "network-facing-GE" level 5 rate max cir 100000
/config qos port-scheduler-policy "network-facing-GE" level 6 rate 50000 cir 50000
->

<- qos_port-scheduler-policy_network-facing-100GE
/config qos port-scheduler-policy "network-facing-100GE" create
/config qos port-scheduler-policy "network-facing-100GE" description "100GE network facing ports"
/config qos port-scheduler-policy "network-facing-100GE" level 1 rate max cir 15000000
/config qos port-scheduler-policy "network-facing-100GE" level 2 rate max cir 4500000
/config qos port-scheduler-policy "network-facing-100GE" level 3 rate max cir 60000000
/config qos port-scheduler-policy "network-facing-100GE" level 4 rate max cir 5000000
/config qos port-scheduler-policy "network-facing-100GE" level 5 rate max cir 15000000
/config qos port-scheduler-policy "network-facing-100GE" level 6 rate 500000 cir 500000
->

<- qos_scheduler-policy_BICI-SCHED
/config qos scheduler-policy "BICI-SCHED" create
/config qos scheduler-policy "BICI-SCHED" description "BI/CI root scheduler"
/config qos scheduler-policy "BICI-SCHED" tier 1 scheduler "BICI-ROOT" create
/config qos scheduler-policy "BICI-SCHED" tier 1 scheduler "BICI-ROOT" port-parent level 3
->

<- qos_network_230
/config qos network 230 create
/config qos network 230 description "RE-CA network QoS policy"
/config qos network 230 ingress dscp be fc be profile in
/config qos network 230 ingress dscp cp1 fc be profile out
/config qos network 230 ingress dscp cs2 fc l2 profile in
/config qos network 230 ingress dscp cs3 fc af profile in
/config qos network 230 ingress dscp cs4 fc l1 profile in
/config qos network 230 ingress dscp cs5 fc ef profile in
/config qos network 230 ingress dscp nc1 fc h1 profile in
/config qos network 230 ingress dscp nc2 fc nc profile in
/config qos network 230 ingress dscp af13 fc l2 profile out
/config qos network 230 ingress dscp af23 fc af profile out
/config qos network 230 ingress dscp af33 fc l1 profile out
/config qos network 230 ingress dscp af41 fc h2 profile in
/config qos network 230 ingress dscp af43 fc h2 profile out
/config qos network 230 ingress dot1p 1 fc be profile use-de
/config qos network 230 ingress dot1p 2 fc l2 profile use-de
/config qos network 230 ingress dot1p 3 fc af profile use-de
/config qos network 230 ingress dot1p 4 fc l1 profile use-de
/config qos network 230 ingress dot1p 5 fc h2 profile use-de
/config qos network 230 ingress dot1p 6 fc ef profile use-de
/config qos network 230 ingress dot1p 7 fc h1 profile use-de
/config qos network 230 egress remarking
/config qos network 230 egress fc af dscp-in-profile cs3
/config qos network 230 egress fc af dscp-out-profile af23
/config qos network 230 egress fc af lsp-exp-in-profile 2
/config qos network 230 egress fc af dot1p-in-profile 3
/config qos network 230 egress fc af dot1p-out-profile 3
/config qos network 230 egress fc af de-mark
/config qos network 230 egress fc be dscp-out-profile cp1
/config qos network 230 egress fc be lsp-exp-out-profile 4
/config qos network 230 egress fc be dot1p-in-profile 1
/config qos network 230 egress fc be dot1p-out-profile 1
/config qos network 230 egress fc be de-mark
/config qos network 230 egress fc ef dscp-in-profile cs5
/config qos network 230 egress fc ef dscp-out-profile cs5
/config qos network 230 egress fc ef lsp-exp-in-profile 6
/config qos network 230 egress fc ef lsp-exp-out-profile 6
/config qos network 230 egress fc ef dot1p-in-profile 6
/config qos network 230 egress fc ef dot1p-out-profile 6
/config qos network 230 egress fc ef de-mark
/config qos network 230 egress fc h1 lsp-exp-in-profile 7
/config qos network 230 egress fc h1 lsp-exp-out-profile 7
/config qos network 230 egress fc h1 dot1p-in-profile 7
/config qos network 230 egress fc h1 dot1p-out-profile 7
/config qos network 230 egress fc h1 de-mark
/config qos network 230 egress fc h2 dscp-out-profile af43
/config qos network 230 egress fc h2 lsp-exp-in-profile 5
/config qos network 230 egress fc h2 lsp-exp-out-profile 5
/config qos network 230 egress fc h2 dot1p-in-profile 5
/config qos network 230 egress fc h2 dot1p-out-profile 5
/config qos network 230 egress fc h2 de-mark
/config qos network 230 egress fc l1 dscp-in-profile cs4
/config qos network 230 egress fc l1 dscp-out-profile af33
/config qos network 230 egress fc l1 lsp-exp-out-profile 3
/config qos network 230 egress fc l1 dot1p-in-profile 4
/config qos network 230 egress fc l1 dot1p-out-profile 4
/config qos network 230 egress fc l1 de-mark
/config qos network 230 egress fc l2 dscp-in-profile cs2
/config qos network 230 egress fc l2 dscp-out-profile af13
/config qos network 230 egress fc l2 dot1p-in-profile 2
/config qos network 230 egress fc l2 dot1p-out-profile 2
/config qos network 230 egress fc l2 de-mark
/config qos network 230 egress fc nc de-mark
->

<- qos_network_231
/config qos network 231 create
/config qos network 231 description "RE-DE/BE network QoS policy"
/config qos network 231 ingress dscp be fc be profile in
/config qos network 231 ingress dscp cp1 fc be profile out
/config qos network 231 ingress dscp cs2 fc l2 profile in
/config qos network 231 ingress dscp cs3 fc af profile in
/config qos network 231 ingress dscp cs4 fc l1 profile in
/config qos network 231 ingress dscp cs5 fc ef profile in
/config qos network 231 ingress dscp nc1 fc h1 profile in
/config qos network 231 ingress dscp nc2 fc nc profile in
/config qos network 231 ingress dscp af13 fc l2 profile out
/config qos network 231 ingress dscp af23 fc af profile out
/config qos network 231 ingress dscp af33 fc l1 profile out
/config qos network 231 ingress dscp af41 fc h2 profile in
/config qos network 231 ingress dscp af43 fc h2 profile out
/config qos network 231 ingress dot1p 1 fc be profile use-de
/config qos network 231 ingress dot1p 2 fc l2 profile use-de
/config qos network 231 ingress dot1p 3 fc af profile use-de
/config qos network 231 ingress dot1p 4 fc l1 profile use-de
/config qos network 231 ingress dot1p 5 fc h2 profile use-de
/config qos network 231 ingress dot1p 6 fc ef profile use-de
/config qos network 231 ingress dot1p 7 fc h1 profile use-de
/config qos network 231 egress remarking
/config qos network 231 egress fc af dscp-in-profile cs3
/config qos network 231 egress fc af dscp-out-profile af23
/config qos network 231 egress fc af lsp-exp-in-profile 2
/config qos network 231 egress fc af dot1p-in-profile 3
/config qos network 231 egress fc af dot1p-out-profile 3
/config qos network 231 egress fc af de-mark
/config qos network 231 egress fc be dscp-out-profile cp1
/config qos network 231 egress fc be lsp-exp-out-profile 4
/config qos network 231 egress fc be dot1p-in-profile 1
/config qos network 231 egress fc be dot1p-out-profile 1
/config qos network 231 egress fc be de-mark
/config qos network 231 egress fc ef dscp-in-profile cs5
/config qos network 231 egress fc ef dscp-out-profile cs5
/config qos network 231 egress fc ef lsp-exp-in-profile 6
/config qos network 231 egress fc ef lsp-exp-out-profile 6
/config qos network 231 egress fc ef dot1p-in-profile 6
/config qos network 231 egress fc ef dot1p-out-profile 6
/config qos network 231 egress fc ef de-mark
/config qos network 231 egress fc h1 lsp-exp-in-profile 7
/config qos network 231 egress fc h1 lsp-exp-out-profile 7
/config qos network 231 egress fc h1 dot1p-in-profile 7
/config qos network 231 egress fc h1 dot1p-out-profile 7
/config qos network 231 egress fc h1 de-mark
/config qos network 231 egress fc h2 dscp-out-profile af43
/config qos network 231 egress fc h2 lsp-exp-in-profile 5
/config qos network 231 egress fc h2 lsp-exp-out-profile 5
/config qos network 231 egress fc h2 dot1p-in-profile 5
/config qos network 231 egress fc h2 dot1p-out-profile 5
/config qos network 231 egress fc h2 de-mark
/config qos network 231 egress fc l1 dscp-in-profile cs4
/config qos network 231 egress fc l1 dscp-out-profile af33
/config qos network 231 egress fc l1 lsp-exp-out-profile 3
/config qos network 231 egress fc l1 dot1p-in-profile 4
/config qos network 231 egress fc l1 dot1p-out-profile 4
/config qos network 231 egress fc l1 de-mark
/config qos network 231 egress fc l2 dscp-in-profile cs2
/config qos network 231 egress fc l2 dscp-out-profile af13
/config qos network 231 egress fc l2 dot1p-in-profile 2
/config qos network 231 egress fc l2 dot1p-out-profile 2
/config qos network 231 egress fc l2 de-mark
/config qos network 231 egress fc nc de-mark
->

<- qos_slope-policy_COLOURED-WRED>
/config qos slope-policy "COLOURED-WRED" create
/config qos slope-policy "COLOURED-WRED" description "MPLS Trunk WRED policy"
/config qos slope-policy "COLOURED-WRED" high-slope start-avg 50
/config qos slope-policy "COLOURED-WRED" high-slope max-avg 100
/config qos slope-policy "COLOURED-WRED" high-slope no shutdown
/config qos slope-policy "COLOURED-WRED" low-slope start-avg 10
/config qos slope-policy "COLOURED-WRED" low-slope max-avg 50
/config qos slope-policy "COLOURED-WRED" low-slope no shutdown
->

#### define Policy rules ####
<- policy_prefix-list_IANA
/config router policy-options prefix-list "IANA" prefix 0.0.0.0/0 through 6
/config router policy-options prefix-list "IANA" prefix 0.0.0.0/8 through 32
/config router policy-options prefix-list "IANA" prefix 127.0.0.0/8 through 32
/config router policy-options prefix-list "IANA" prefix 169.254.0.0/16 through 32
/config router policy-options prefix-list "IANA" prefix 192.0.0.0/24 through 32
/config router policy-options prefix-list "IANA" prefix 192.0.2.0/24 through 32
/config router policy-options prefix-list "IANA" prefix 198.18.0.0/15 through 32
/config router policy-options prefix-list "IANA" prefix 198.51.100.0/24 through 32
/config router policy-options prefix-list "IANA" prefix 203.0.113.0/24 through 32
/config router policy-options prefix-list "IANA" prefix 224.0.0.0/3 through 32
->

<- policy_prefix-list_RFC1918
/config router policy-options prefix-list "RFC1918" prefix 10.0.0.0/8 longer
/config router policy-options prefix-list "RFC1918" prefix 172.16.0.0/12 longer
/config router policy-options prefix-list "RFC1918" prefix 192.168.0.0/16 longer
->

<- policy_prefix-list_DEFAULT
/config router policy-options prefix-list "DEFAULT" prefix 0.0.0.0/0 exact
->

<- policy_prefix-list_25-TO-32
/config router policy-options prefix-list "/25-TO-/32" prefix 0.0.0.0/0 prefix-length-range 25-32
->

<- policy_prefix-list_DEFAULT-IPV6
/config router policy-options prefix-list "DEFAULT-IPV6" prefix ::/0 exact
->

<- policy_prefix-list_IANA-IPV6_SROS11
<#condition=get_version=(TiMOS-C-11.0.R18|TiMOS-C-11.0.R12)>
/config router policy-options prefix-list "IANA-IPV6" prefix ::/8 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 100::/8 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 200::/7 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 4000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 6000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 8000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix A000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix C000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix E000::/4 longer
/config router policy-options prefix-list "IANA-IPV6" prefix F000::/5 longer
/config router policy-options prefix-list "IANA-IPV6" prefix F800::/6 longer
/config router policy-options prefix-list "IANA-IPV6" prefix FE00::/9 longer
/config router policy-options prefix-list "IANA-IPV6" prefix FEC0::/10 longer
->

<- policy_prefix-list_IANA-IPV6_SROS13
<#condition=get_version=TiMOS-C-13.0.R10>
/config router policy-options prefix-list "IANA-IPV6" prefix ::/8 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 100::/8 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 200::/7 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 400::/6 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 800::/5 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 1000::/4 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 4000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 6000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix 8000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix a000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix c000::/3 longer
/config router policy-options prefix-list "IANA-IPV6" prefix e000::/4 longer
/config router policy-options prefix-list "IANA-IPV6" prefix f000::/5 longer
/config router policy-options prefix-list "IANA-IPV6" prefix f800::/6 longer
/config router policy-options prefix-list "IANA-IPV6" prefix fe00::/9 longer
/config router policy-options prefix-list "IANA-IPV6" prefix fec0::/10 longer
->


<- policy_prefix-list_RFC4193-IPV6_SROS11
<#condition=get_version=(TiMOS-C-11.0.R18|TiMOS-C-11.0.R12)>
/config router policy-options prefix-list "RFC4193-IPV6" prefix FC00::/7 longer
->

<- policy_prefix-list_RFC4193-IPV6_SROS13
<#condition=get_version=TiMOS-C-13.0.R10>
/config router policy-options prefix-list "RFC4193-IPV6" prefix fc00::/7 longer
->

<- policy_prefix-list_49-TO-128-IPv6
/config router policy-options prefix-list "/49-TO-/128-IPV6" prefix ::/0 prefix-length-range 49-128
->

<- policy_prefix-list_TELUS-INTERNAL-NA-INFRASTRUCTURE_SROS11
<#condition=get_version=(TiMOS-C-11.0.R18|TiMOS-C-11.0.R12)>
/config router policy-options prefix-list "TELUS-INTERNAL-NA-INFRASTRUCTURE" prefix 2001:568:F000::/40 longer
->

<- policy_prefix-list_TELUS-INTERNAL-NA-INFRASTRUCTURE_SROS13
<#condition=get_version=TiMOS-C-13.0.R10>
/config router policy-options prefix-list "TELUS-INTERNAL-NA-INFRASTRUCTURE" prefix 2001:568:f000::/40 longer
->

<- policy_community_global
/config router policy-options community "100" members "852:100"
/config router policy-options community "200" members "852:200"
/config router policy-options community "210" members "852:210"
/config router policy-options community "300" members "852:300"
/config router policy-options community "RT_PERF_NON_HUB" members "target:852:4441"
/config router policy-options community "RT_PERF_HUB" members "target:852:4440"
/config router policy-options community "RT_CPE_MGMT" members "target:852:5"
/config router policy-options community "RT_NMC_MGMT" members "target:852:4"
/config router policy-options community "NO-ADVERTISE" members "no-advertise"
/config router policy-options community "BLACKHOLE" members "852:59666"
/config router policy-options community "NO-EXPORT" members "no-export"
/config router policy-options community "SSC_NO_IMPORT" members "852:58002"
/config router policy-options community "CUST" members "852:(50403|50604|50416|50514)"
/config router policy-options community "PEER" members "852:(17403|17604|17416|17514|18403|18604|18416|18514)"
/config router policy-options community "AGGREGATE" members "852:31..0"
/config router policy-options community "IPV6" members "852:40000"
/config router policy-options community "RT_TQ_NMC_MGMT" members "target:852:10"
/config router policy-options community "RT_TQ_CPE_MGMT" members "target:852:11"
->

<- policy_community_consumer
<#type=dynamic>
<#match=any_if_found>
<#instance = /config subscriber-mgmt authentication-policy "(ssc_auth_policy)" create>
r</config router policy-options community "CONSUMER-s<HOSTNAME>" members "852:31\d{2}2" "852:62002">
r</config router policy-options community "CONSUMER-STB-s<HOSTNAME>" members "852:31\d{2}2" "852:62002" "no-export">
r</config router policy-options community "CONSUMER-CPE-s<HOSTNAME>" members "852:31\d{2}2" "852:62002" "no-export">
r</config router policy-options community "CONSUMER-DV-s<HOSTNAME>" members "852:31\d{2}2" "852:62002" "no-export">
->

<- policy_community_BI-CI
<#condition=get_version=TiMOS-C-13.0.R10>
r</config router policy-options community "BICI-EXPORT-s<HOSTNAME>" members "852:20\d{3}" "852:31\d{2}4">
r</config router policy-options community "BICI-NO-EXPORT-s<HOSTNAME>" members "852:20\d{3}" "852:31\d{2}1" "852:62001">
->

<- policy_as-path
/config router policy-options as-path "AS-PATH-TOO-LONG" expression ".{60,}"
/config router policy-options as-path "AS852" expression "^$"
->


<- policy_policy-statement_DEFAULT-ONLY
/config router policy-options policy-statement "DEFAULT-ONLY" entry 10 from prefix-list "DEFAULT"
/config router policy-options policy-statement "DEFAULT-ONLY" entry 10 to protocol bgp
/config router policy-options policy-statement "DEFAULT-ONLY" entry 10 action accept
/config router policy-options policy-statement "DEFAULT-ONLY" default-action reject
->

<- policy_policy-statement_DEFAULT-ONLY-V4-V6
<#condition=get_version=TiMOS-C-13.0.R10>
/config router policy-options policy-statement "DEFAULT-ONLY-V4-V6" entry 10 from prefix-list "DEFAULT"
/config router policy-options policy-statement "DEFAULT-ONLY-V4-V6" entry 10 to protocol bgp
/config router policy-options policy-statement "DEFAULT-ONLY-V4-V6" entry 10 action accept
/config router policy-options policy-statement "DEFAULT-ONLY-V4-V6" default-action next-policy
->

<- policy_policy-statement_CUST-FULL-OUT
/config router policy-options policy-statement "CUST-FULL-OUT" entry 10 description "deny bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 10 from prefix-list "DEFAULT"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 10 action reject
/config router policy-options policy-statement "CUST-FULL-OUT" entry 20 description "deny bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 20 from prefix-list "IANA-BI"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 20 action reject
/config router policy-options policy-statement "CUST-FULL-OUT" entry 30 description "deny bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 30 from prefix-list "RFC1918"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 30 action reject
/config router policy-options policy-statement "CUST-FULL-OUT" entry 40 description "deny small routes"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 40 from prefix-list "/25-TO-/32"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 40 action reject
/config router policy-options policy-statement "CUST-FULL-OUT" entry 50 description "advertise TELUS customer routes with external community tag"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 50 from community "CUST"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 50 action accept community replace "200"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 50 action accept origin igp
/config router policy-options policy-statement "CUST-FULL-OUT" entry 60 description "advertise TELUS peering routes with external community tag"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 60 from community "PEER"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 60 action accept community replace "180"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 60 action accept origin igp
/config router policy-options policy-statement "CUST-FULL-OUT" entry 70 description "advertise TELUS transit routes with external community tag"
/config router policy-options policy-statement "CUST-FULL-OUT" entry 70 action accept origin igp
->


<- policy_policy-statement_CUST-FULL-OUT-V4-V6
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 10 description "Deny IPv4 bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 10 from prefix-list "DEFAULT"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 10 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 20 description "Deny IPv4 bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 20 from prefix-list "IANA-BI"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 20 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 30 description "Deny IPv4 bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 30 from prefix-list "RFC1918"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 30 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 40 description "Deny IPv4 small routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 40 from prefix-list "/25-TO-/32"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 40 from family ipv4
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 40 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 50 description "Deny IPv6 bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 50 from prefix-list "DEFAULT-IPV6"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 50 from family ipv6
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 50 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 60 description "Deny IPv6 bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 60 from prefix-list "IANA-IPV6"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 60 from family ipv6
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 60 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 70 description "Deny IPv6 bogus routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 70 from prefix-list "RFC4193-IPV6"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 70 from family ipv6
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 70 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 80 description "Deny IPv6 small routes"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 80 from prefix-list "/49-TO-/128-IPV6"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 80 from family ipv6
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 80 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 90 description "Deny TELUS non-advertised subnets"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 90 from prefix-list "TELUS-INTERNAL-NA-INFRASTRUCTURE"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 90 from family ipv6
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 90 action reject
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 100 description "advertise TELUS customer routes with external community tag"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 100 from community "CUST"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 100 from family ipv4
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 100 action accept community replace "200"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 100 action accept origin igp
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 110 description "advertise TELUS peering routes with external community tag"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 110 from community "PEER"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 110 from family ipv4
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 110 action accept community replace "180"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 110 action accept origin igp
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 120 description "advertise TELUS transit routes with external community tag"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 120 from family ipv4
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 120 action accept community replace "170"
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" entry 120 action accept origin igp
/config router policy-options policy-statement "CUST-FULL-OUT-V4-V6" default-action next-policy
->

<- policy_policy-statement_ALLOW-BLACKHOLE
/config router policy-options policy-statement "ALLOW-BLACKHOLE" description "accept the blackhole-tagged prefixes"
/config router policy-options policy-statement "ALLOW-BLACKHOLE" entry 10 from community "BLACKHOLE"
/config router policy-options policy-statement "ALLOW-BLACKHOLE" entry 10 to protocol bgp
/config router policy-options policy-statement "ALLOW-BLACKHOLE" entry 10 action accept
/config router policy-options policy-statement "ALLOW-BLACKHOLE" default-action next-policy
->


<- policy_policy-statement_CUSTOMER-IN-BI-V4-V6
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 10 description "Deny bogus prefixes from customers"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 10 from prefix-list "DEFAULT"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 10 action reject
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 20 description "Deny bogus prefixes from customers"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 20 from prefix-list "IANA-BI"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 20 action reject
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 30 description "Deny bogus prefixes from customers"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 30 from prefix-list "RFC1918"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 30 action reject
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 40 description "Deny prefixes with ASN path length > 60"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 40 from as-path "AS-PATH-TOO-LONG"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 40 action reject
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 50 description "Deny bogus routes from peers"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 50 from prefix-list "DEFAULT-IPV6"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 50 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 50 action reject
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 60 description "Deny bogus routes from peers"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 60 from prefix-list "IANA-IPV6"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 60 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 60 action reject
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 70 description "Deny bogus routes from peers"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 70 from prefix-list "RFC4193-IPV6"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 70 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 70 action reject
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 80 description "Deny TELUS non-advertised subnets"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 80 from prefix-list "TELUS-INTERNAL-NA-INFRASTRUCTURE"
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 80 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-BI-V4-V6" entry 80 action reject
->

<- policy_policy-statement_CUSTOMER-IN-CI-V4-V6
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 10 description "Deny bogus prefixes from customers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 10 from prefix-list "DEFAULT"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 10 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 20 description "Deny bogus prefixes from customers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 20 from prefix-list "IANA-BI"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 20 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 30 description "Deny bogus prefixes from customers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 30 from prefix-list "RFC1918"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 30 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 40 description "Deny small V4 prefixes from customers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 40 from prefix-list "/25-TO-/32"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 40 from family ipv4
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 40 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 50 description "Deny prefixes with ASN path length > 60"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 50 from as-path "AS-PATH-TOO-LONG"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 50 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 60 description "Deny bogus V6 routes from peers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 60 from prefix-list "DEFAULT-IPV6"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 60 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 60 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 70 description "Deny bogus V6 routes from peers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 70 from prefix-list "IANA-IPV6"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 70 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 70 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 80 description "Deny bogus V6 routes from peers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 80 from prefix-list "RFC4193-IPV6"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 80 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 80 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 90 description "Deny small V6 prefixes from peers"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 90 from prefix-list "/49-TO-/128-IPV6"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 90 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 90 action reject
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 100 description "Deny TELUS non-advertised subnets"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 100 from prefix-list "TELUS-INTERNAL-NA-INFRASTRUCTURE"
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 100 from family ipv6
/config router policy-options policy-statement "CUSTOMER-IN-CI-V4-V6" entry 100 action reject
->

<- policy_policy-statement_RE-EXPORT-IPV4
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 10 from source-address 154.11.0.255
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 10 action reject
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 20 from protocol bgp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 20 action accept
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 40 from prefix-list "CONSUMER-s<HOSTNAME>"
r</config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 40 action accept community add "CONSUMER-s<HOSTNAME>" "COM-\w{8}(?:CA|PE|RE)\d{2}" "COM-\w{8}(?:CA|PE|RE)\d{2}">
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 50 from prefix-list "CONSUMER-STB-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 50 action accept community add "CONSUMER-STB-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 60 from prefix-list "CONSUMER-DV-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 60 action accept community add "CONSUMER-DV-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 70 from prefix-list "CONSUMER-CPE-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 70 action accept community add "CONSUMER-CPE-s<HOSTNAME>"
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 510 description "Assign NO-EXPORT community to IPv4 Routes provided by Telus"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 510 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 510 from prefix-list "STATIC-BGP-V4-NE-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 510 action next-entry community add "NO-EXPORT"
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 511 description "Allow white-listed IPv4 prefixes, NO-EXPORT, TELUS-Provided prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 511 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 511 from prefix-list "STATIC-BGP-V4-NE-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 511 action accept community add "BICI-NO-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 511 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 511 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 520 description "Assign NO-EXPORT community to IPv4 Routes provided by Telus, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 520 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 520 from prefix-list "STATIC-V4-NE-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 520 action next-entry community add "NO-EXPORT"
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 521 description "Allow white-listed IPv4 prefixes, NO-EXPORT, TELUS-Provided prefixes, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 521 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 521 from prefix-list "STATIC-V4-NE-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 521 action accept community add "BICI-NO-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 521 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 521 action accept local-preference 350
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 521 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 530 description "Assign NO-EXPORT community to IPv4 Routes provided by Telus, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 530 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 530 from prefix-list "STATIC-V4-NE-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 530 action next-entry community add "NO-EXPORT"
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 531 description "Allow white-listed IPv4 prefixes, NO-EXPORT, TELUS-Provided prefixes, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 531 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 531 from prefix-list "STATIC-V4-NE-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 531 action accept community add "BICI-NO-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 531 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 531 action accept local-preference 340
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 531 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 540 description "Allow white-listed IPv4 prefixes - EXPORT, Customer-Owned prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 540 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 540 from prefix-list "STATIC-BGP-V4-E-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 540 action accept community add "BICI-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 540 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 540 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 550 description "Allow white-listed IPv4 prefixes - EXPORT, Customer-Owned prefixes, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 550 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 550 from prefix-list "STATIC-V4-E-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 550 action accept community add "BICI-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 550 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 550 action accept local-preference 350
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 550 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 560 description "Allow white-listed IPv4 prefixes - EXPORT, Customer-Owned prefixes, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 560 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 560 from prefix-list "STATIC-V4-E-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 560 action accept community add "BICI-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 560 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 560 action accept local-preference 340
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 560 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 710 description "Direct Connected IPv4 export without LP"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 710 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 710 from prefix-list "DIRECT-BGP-V4-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 710 action accept community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 710 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 710 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 720 description "Direct Connected IPv4 export with LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 720 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 720 from prefix-list "DIRECT-BGP-V4-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 720 action accept community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 720 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 720 action accept local-preference 350
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 720 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 730 description "Direct Connected IPv4 export with LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 730 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 730 from prefix-list "DIRECT-BGP-V4-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 730 action accept community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 730 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 730 action accept local-preference 340
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 730 action accept next-hop-self
#/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 740 description "Assign NO-EXPORT community to BRIX IPv4 prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 740 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 740 from prefix-list "BRIX-BGP-V4-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 740 action accept community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 740 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" entry 740 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV4-s<HOSTNAME>" default-action next-policy
->

<- policy_policy-statement_RE-IMPORT-IPV4
/config router policy-options policy-statement "RE-IMPORT-IPV4-s<HOSTNAME>" entry 10 from protocol bgp
/config router policy-options policy-statement "RE-IMPORT-IPV4-s<HOSTNAME>" entry 10 from community "SSC_NO_IMPORT"
r</config router policy-options policy-statement "RE-IMPORT-IPV4-s<HOSTNAME>" entry 10 action (?:reject|accept)>
/config router policy-options policy-statement "RE-IMPORT-IPV4-s<HOSTNAME>" entry 20 description "Deny prefixes with ASN path length > 60"
/config router policy-options policy-statement "RE-IMPORT-IPV4-s<HOSTNAME>" entry 20 from as-path "AS-PATH-TOO-LONG"
/config router policy-options policy-statement "RE-IMPORT-IPV4-s<HOSTNAME>" entry 20 action reject
/config router policy-options policy-statement "RE-IMPORT-IPV4-s<HOSTNAME>" default-action next-policy
->

<- policy_policy-statement_RE-EXPORT-IPV6
r</config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 10 from source-address 2001:568:[Ff]000::1>
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 10 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 10 action reject
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 20 from protocol bgp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 20 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 20 action accept
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 510 description "Assign NO-EXPORT community to IPv6 Routes provided by Telus"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 510 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 510 from prefix-list "STATIC-BGP-V6-NE-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 510 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 510 action next-entry community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 511 description "Allow white-listed IPv6 prefixes, Assign IPv6, TELUS-Provided prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 511 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 511 from prefix-list "STATIC-BGP-V6-NE-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 511 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 511 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 512 description "Allow white-listed IPv6 prefixes, Assign BI/CI, TELUS-Provided prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 512 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 512 from prefix-list "STATIC-BGP-V6-NE-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 512 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 512 action accept community add "BICI-NO-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 512 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 512 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 520 description "Assign NO-EXPORT community to IPv6 Routes provided by Telus, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 520 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 520 from prefix-list "STATIC-V6-NE-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 520 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 520 action next-entry community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 521 description "Allow white-listed IPv6 prefixes, Assign IPv6, TELUS-Provided prefixes, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 521 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 521 from prefix-list "STATIC-V6-NE-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 521 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 521 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 description "Allow white-listed IPv6 prefixes, Assign BI/CI, TELUS-Provided prefixes, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 from prefix-list "STATIC-V6-NE-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 action accept community add "BICI-NO-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 action accept local-preference 350
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 522 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 530 description "Assign NO-EXPORT community to IPv6 Routes provided by Telus, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 530 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 530 from prefix-list "STATIC-V6-NE-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 530 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 530 action next-entry community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 531 description "Allow white-listed IPv6 prefixes, Assign IPv6, TELUS-Provided prefixes, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 531 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 531 from prefix-list "STATIC-V6-NE-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 531 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 531 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 description "Allow white-listed IPv6 prefixes, Assign BI/CI, TELUS-Provided prefixes, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 from prefix-list "STATIC-V6-NE-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 action accept community add "BICI-NO-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 action accept local-preference 340
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 532 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 540 description "Allow white-listed IPv6 prefixes, Assign IPv6, Customer-Owned prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 540 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 540 from prefix-list "STATIC-BGP-V6-E-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 540 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 540 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 541 description "Allow white-listed IPv6 prefixes, Assign BI/CI, Customer-Owned prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 541 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 541 from prefix-list "STATIC-BGP-V6-E-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 541 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 541 action accept community add "BICI-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 541 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 541 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 550 description "Allow white-listed IPv6 prefixes, Assign IPv6, Customer-Owned prefixes, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 550 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 550 from prefix-list "STATIC-V6-E-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 550 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 550 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 description "Allow white-listed IPv6 prefixes, Assign BI/CI, Customer-Owned prefixes, LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 from prefix-list "STATIC-V6-E-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 action accept community add "BICI-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 action accept local-preference 350
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 551 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 560 description "Allow white-listed IPv6 prefixes, Assign IPv6, Customer-Owned prefixes, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 560 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 560 from prefix-list "STATIC-V6-E-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 560 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 560 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 description "Allow white-listed IPv6 prefixes, Assign BI/CI, Customer-Owned prefixes, LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 from protocol static
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 from prefix-list "STATIC-V6-E-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 action accept community add "BICI-EXPORT-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 action accept local-preference 340
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 561 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 710 description "Direct Connected IPv6 export without LP"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 710 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 710 from prefix-list "DIRECT-BGP-V6-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 710 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 710 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 711 description "Direct Connected IPv6 export without LP"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 711 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 711 from prefix-list "DIRECT-BGP-V6-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 711 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 711 action accept community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 711 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 711 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 720 description "Direct Connected IPv6 export LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 720 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 720 from prefix-list "DIRECT-BGP-V6-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 720 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 720 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 description "Direct Connected IPv6 export LP 350"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 from prefix-list "DIRECT-BGP-V6-LP350-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 action accept community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 action accept local-preference 350
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 721 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 730 description "Direct Connected IPv6 export LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 730 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 730 from prefix-list "DIRECT-BGP-V6-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 730 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 730 action next-entry community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 description "Direct Connected IPv6 export LP 340"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 from prefix-list "DIRECT-BGP-V6-LP340-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 action accept community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 action accept origin igp
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 action accept local-preference 340
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 731 action accept next-hop-self
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 740 description "Assign NO-EXPORT community to BRIX IPv6 prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 740 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 740 from prefix-list "BRIX-BGP-V6-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 740 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 740 action next-entry community add "NO-EXPORT"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 741 description "Assign IPv6 community to BRIX IPv6 prefixes"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 741 from protocol direct
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 741 from prefix-list "BRIX-BGP-V6-s<HOSTNAME>"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 741 from family ipv6
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" entry 741 action accept community add "IPV6"
/config router policy-options policy-statement "RE-EXPORT-IPV6-s<HOSTNAME>" default-action next-policy
->

<- policy_policy-statement_RE-IMPORT-IPV6_SROS11
<#condition=get_version=(TiMOS-C-11.0.R18|TiMOS-C-11.0.R12)>
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 description "Accept IPv6 aggregates; set next-hop to black hole"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from protocol bgp
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from as-path "AS852"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from community "AGGREGATE"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from family ipv6
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 action accept next-hop 2001:568:F000::1
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 description "Accept IPv6 prefixes destined for black hole"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from protocol bgp
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from as-path "AS852"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from community "BLACKHOLE"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from family ipv6
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 action accept next-hop 2001:568:F000::1
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" default-action next-policy
->

<- policy_policy-statement_RE-IMPORT-IPV6_SROS13
<#condition=get_version=TiMOS-C-13.0.R10>
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 description "Accept IPv6 aggregates; set next-hop to black hole"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from protocol bgp
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from as-path "AS852"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from community "AGGREGATE"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 from family ipv6
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 10 action accept next-hop 2001:568:f000::1
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 description "Accept IPv6 prefixes destined for black hole"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from protocol bgp
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from as-path "AS852"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from community "BLACKHOLE"
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 from family ipv6
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" entry 20 action accept next-hop 2001:568:f000::1
/config router policy-options policy-statement "RE-IMPORT-IPV6-s<HOSTNAME>" default-action next-policy
->

